<!DOCTYPE html>
<html><head><title>Simplifier Configuration Variables</title><meta charset="UTF-8"><meta content="width=device-width, initial-scale=1" name="viewport"><meta content="Emmy uses a number of dynamic variables to tune the behavior of the simplifier without having to thread explicit maps of options through the rulesets. This design is not optimal; in a future version, we&apos;ll move any rules that depend on these out to their own rulesets, and move the configuration variables over to [[emmy.simplify]]." property="og:description"><meta content="Simplifier Configuration Variables" property="og:title"><meta content="article:clerk" property="og:type"><meta content="summary_large_image" name="twitter:card"><script src="https://cdn.tailwindcss.com?plugins=typography" type="text/javascript"></script><script>tailwind.config = {
  darkMode: "class",
  content: ["./tw/viewer.js", "./tw/**/*.edn"],
  safelist: ['dark'],
  theme: {
    extend: {},
    fontFamily: {
      sans: ["Fira Sans", "-apple-system", "BlinkMacSystemFont", "sans-serif"],
      serif: ["PT Serif", "serif"],
      mono: ["Fira Mono", "monospace"]
    }
  },
  variants: {
    extend: {},
  },
  plugins: [],
}
</script><style type="text/tailwindcss">@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  html {
    font-size: 18px;
  }
  @media (max-width: 600px) {
    html {
      font-size: 16px;
    }
  }
  .font-condensed { font-family: "Fira Sans Condensed", sans-serif; }
  .font-inter     { font-family: "Inter", sans-serif; }
  body {
    @apply font-serif antialiased text-gray-900 sm:overscroll-y-none;
  }
  code, .code {
    @apply font-mono text-sm text-gray-900 bg-slate-50 px-0.5 py-px rounded dark:bg-gray-800;
  }
  code::before, code::after { @apply content-none !important; }
  h1, h3, h4, h5, h6 {
    @apply font-condensed font-bold mt-8 first:mt-0;
  }
  h2 {
    /*We cannot collapse margins due to nesting but we want to*/
    /*keep the h2’s large margin visible*/
    @apply font-condensed font-bold mt-8 first:mt-2;
  }
  h1 { @apply text-4xl; }
  h2 { @apply text-3xl; }
  h3 { @apply text-2xl; }

  @media print {
      h1 { @apply text-2xl !important; }
      h2 { @apply text-xl !important; }
      h3 { @apply text-lg !important; }
  }

  button { @apply focus:outline-none; }
  strong { @apply font-bold; }
  em     { @apply italic; }
  pre    { @apply m-0 font-mono; }
}

/* Compatibility */
/* --------------------------------------------------------------- */
/* TODO: Verify which colors are in use and replace with Tailwind
   colors accordingly. Move Nj-specific styles out of here. */

:root {
  --teal-color: #31afd0;
  --dark-teal-color: #095960;
  --near-black-color: #2e2e2c;
  --red-color: #d64242;
  --dark-blue-color: #1f2937;
  --dark-blue-60-color: rgba(28, 42, 56, 0.6);
  --gray-panel-color: rgba(239, 241, 245, 1.000);
  --brand-color: var(--dark-blue-color);
  --link-color: #5046e4;
  --command-bar-selected-color: var(--teal-color);
}

.serif      { @apply font-serif; }
.sans-serif { @apply font-sans; }
.monospace  { @apply font-mono; }
.inter      { @apply font-inter; }

.border-color-teal { border-color: var(--dark-teal-color); }
.teal { color: var(--teal-color); }
.bg-dark-blue { background: var(--dark-blue-color); }
.bg-dark-blue-60 { background: rgba(28, 42, 56, 0.6); }
.bg-gray-panel { background: var(--gray-panel-color); }
.text-dark-blue  { color: var(--dark-blue-color); }
.text-dark-blue-60 { color: var(--dark-blue-60-color); }
.border-dark-blue-30 { border-color: rgba(28, 42, 56, 0.6); }
.text-brand { color: var(--dark-blue-color); }
.bg-brand { background: var(--dark-blue-color); }
.text-selected { color: white; }
.red { color: var(--red-color); }

/* Disclose Button */
/* --------------------------------------------------------------- */

.disclose {
  @apply content-none border-solid cursor-pointer inline-block relative mr-[3px] top-[-2px] transition-all;
  border-color: var(--near-black-color) transparent;
  border-width: 6px 4px 0;
}
.disclose:hover {
  border-color: var(--near-black-color) transparent;
}
.dark .disclose,
.dark .disclose:hover {
  border-color: white transparent;
}
.disclose.collapsed {
  @apply rotate-[-90deg];
}

/* Layout */
/* --------------------------------------------------------------- */

.page {
  @apply max-w-5xl mx-auto px-12 box-border flex-shrink-0;
}
.max-w-prose { @apply max-w-[46rem] !important; }
.max-w-wide  { @apply max-w-3xl !important; }

/* List Styles */
/* --------------------------------------------------------------- */

.task-list-item + .task-list-item,
.markdown-viewer ul ul {
  @apply mt-1 mb-0;
}

/* compact TOC */
.markdown-viewer .toc ul {
  list-style: none;
  @apply my-1;
}

/* Code Viewer */
/* --------------------------------------------------------------- */

.code-viewer {
  @apply font-mono bg-slate-100 rounded-sm text-sm overflow-x-auto dark:bg-gray-800;
}
.code-listing  {
    @apply -ml-8 -mr-8 relative !important;
}
.code-viewer .cm-content {
  @apply py-4 px-8;
}
@media (min-width: 960px){
    .notebook-viewer .code-viewer .cm-content {
        @apply py-4 pl-12;
    }
    .notebook-viewer .code-listing {
        width: 48rem !important;
        @apply -ml-12 mr-0 !important;
    }
}
/* Don’t show focus outline when double-clicking cell in Safari */
.cm-scroller { @apply focus:outline-none; }

/* Syntax Highlighting */
/* --------------------------------------------------------------- */

.inspected-value { @apply text-xs font-mono leading-[1.25rem]; }
.cmt-strong, .cmt-heading { @apply font-bold; }
.cmt-italic, .cmt-emphasis { @apply italic; }
.cmt-strikethrough { @apply line-through; }
.cmt-link { @apply underline; }
.untyped-value { @apply whitespace-nowrap; }

.cm-editor, .cmt-default, .result-viewer {
  @apply text-slate-800 dark:text-slate-300;
}
.cmt-keyword {
  @apply text-purple-800 dark:text-pink-400;
}
.cmt-atom, .cmt-bool, .cmt-url, .cmt-contentSeparator, .cmt-labelName {
  @apply text-blue-900 dark:text-blue-300;
}
.cmt-inserted, .cmt-literal {
  @apply text-emerald-700 dark:text-emerald-200;
}
.cmt-string, .cmt-deleted {
  @apply text-rose-700 dark:text-sky-300;
}
.cmt-italic.cmt-string {
  @apply dark:text-sky-200;
}
.cmt-regexp, .cmt-escape {
  @apply text-orange-500 dark:text-orange-300;
}
.cmt-variableName {
  @apply text-blue-800 dark:text-sky-300;
}
.cmt-typeName, .cmt-namespace {
  @apply text-emerald-600 dark:text-emerald-300;
}
.cmt-className {
  @apply text-teal-600 dark:text-teal-200;
}
.cmt-macroName {
  @apply text-teal-700 dark:text-teal-200;
}
.cmt-propertyName {
  @apply text-blue-700 dark:text-blue-200;
}
.cmt-comment {
  @apply text-slate-500 dark:text-slate-400;
}
.cmt-meta {
  @apply text-slate-600 dark:text-slate-400;
}
.cmt-invalid {
  @apply text-red-500 dark:text-red-300;
}

.result-data {
  @apply font-mono text-sm overflow-x-auto whitespace-nowrap leading-normal;
}
.result-data::-webkit-scrollbar, .path-nav::-webkit-scrollbar {
  @apply h-0;
}
.result-data-collapsed {
  @apply whitespace-nowrap;
}
.result-data-field {
  @apply ml-4 whitespace-nowrap;
}
.result-data-field-link{
  @apply ml-4 whitespace-nowrap cursor-pointer;
}
.result-data-field-link:hover {
  @apply text-black bg-black/5;
}
.result-text-empty {
  color: rgba(0,0,0,.3);
}
.browsify-button:hover {
  box-shadow: -2px 0 0 2px #edf2f7;
}

/* Prose */
/* --------------------------------------------------------------- */

.notebook-viewer,
.markdown-viewer {
  @apply prose
    dark:prose-invert
    prose-a:text-blue-600 prose-a:no-underline hover:prose-a:underline
    dark:prose-a:text-blue-300
    prose-p:mt-4 prose-p:leading-snug
    prose-ol:mt-4 prose-ol:mb-6 prose-ol:leading-snug
    prose-ul:mt-4 prose-ul:mb-6 prose-ul:leading-snug
    prose-blockquote:mt-4 prose-blockquote:leading-snug
    prose-hr:mt-6 prose-hr:border-t-2 prose-hr:border-solid prose-hr:border-slate-200
    prose-figure:mt-4
    prose-figcaption:mt-2 prose-figcaption:text-xs
    prose-headings:mb-4
    prose-table:mt-0
    prose-th:mb-0
    prose-img:my-0
    prose-code:font-medium prose-code:bg-slate-100
    max-w-none;
}
.markdown-viewer blockquote p:first-of-type:before,
.markdown-viewer blockquote p:last-of-type:after {
  @apply content-none;
}
.markdown-node-viewer.result-viewer.fragment-item {
    @apply mb-0 !important;
}

/* Images */
/* --------------------------------------------------------------- */


/* Todo Lists */
/* --------------------------------------------------------------- */

.contains-task-list {
  @apply pl-6 list-none;
}
.contains-task-list input[type="checkbox"] {
  @apply appearance-none h-4 w-4 rounded border border-slate-200 relative mr-[0.3rem] ml-[-1.5rem] top-[0.15rem];
}
.contains-task-list input[type="checkbox"]:checked {
  @apply border-indigo-600 bg-indigo-600 bg-no-repeat bg-contain;
  background-image: url("data:image/svg+xml,%3csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3e%3cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3e%3c/svg%3e");
}

/* Markdown TOC */
/* --------------------------------------------------------------- */

.markdown-viewer .toc      { @apply mt-4; }
.markdown-viewer h1 + .toc { @apply mt-8; }

.markdown-viewer .toc h1,
.markdown-viewer .toc h2,
.markdown-viewer .toc h3,
.markdown-viewer .toc h4,
.markdown-viewer .toc h5,
.markdown-viewer .toc h6 {
  @apply text-base text-indigo-600 font-sans my-0;
}
.markdown-viewer .toc a {
  @apply text-indigo-600 font-normal no-underline hover:underline;
}
.markdown-viewer .toc li    { @apply m-0; }
.markdown-viewer .toc ul ul { @apply pl-4; }

/* Notebook Spacing */
/* --------------------------------------------------------------- */

.notebook-viewer { @apply py-16; }
#clerk-static-app .notebook-viewer { @apply pt-[0.8rem] pb-16; }
.markdown-viewer *:first-child:not(.code-viewer):not(li):not(h2):not(.sidenote) { @apply mt-0; }
/*.viewer + .viewer { @apply mt-6; }*/
.viewer + .result-viewer { @apply mt-0; }
.code-viewer + .result-viewer { @apply mt-3; }
.markdown-viewer + .markdown-viewer { @apply mt-0; }

/* Sidenotes */
/* --------------------------------------------------------------- */

.sidenote-ref {
  @apply top-[-0.5em] w-auto h-auto inline border-0 bg-transparent m-0 pointer-events-none;
}
.sidenote {
  @apply block font-sans text-xs mt-4 bg-slate-100 dark:bg-slate-800 p-4;
  font-style: normal;
  font-weight: normal;
}
.sidenote-container {
  @apply mb-4;
}
@media (min-width: 860px) {
  .sidenote sup { @apply inline; }
  .sidenote-column {
    @apply w-[165px] absolute right-0 top-0 -mr-[205px];
  }
  .sidenote {
    @apply bg-transparent dark:bg-transparent p-0;
  }
  .sidenote:first-child {
    @apply mt-1;
  }
  .sidenotes-layout .markdown-viewer {
    @apply pr-[241px];
  }
  .sidenote-container {
    @apply relative mb-0;
  }
  .sidenotes-layout h1 {
    @apply w-[756px] !important;
  }
}
.code-viewer + .viewer:not(.code-viewer):not(.code-viewer-folded),
.code-viewer-folded + .viewer:not(.code-viewer):not(.code-viewer-folded),
.result-viewer:not(.markdown-node-viewer) + .result-viewer {
  @apply mt-2;
}
.code-viewer + .code-viewer-folded {
  @apply mt-4;
}
.result-viewer {
  @apply leading-tight mb-6;
}
.code-viewer.fragment-item.result-viewer {
  @apply mb-0 !important;
}
.result-viewer figure {
  @apply mt-0 !important;
}
@media (min-width: 768px) {
  .devcard-desc > div {
    @apply max-w-full m-0;
  }
}

/* Command Palette */
/* --------------------------------------------------------------- */

.nj-commands-input {
  @apply bg-transparent text-white;
}
.nj-context-menu-item:hover:not([disabled]) {
  @apply cursor-pointer;
  background-color: rgba(255,255,255,.14);
}

/* Devdocs */
/* --------------------------------------------------------------- */

.logo, .logo-white {
  @apply block indent-[-999em];
  background: url(/images/nextjournal-logo.svg) center center no-repeat;
}
.devdocs-body {
  @apply font-inter;
}

/* Workarounds */
/* --------------------------------------------------------------- */

/* Fixes vega viewer resizing into infinity */
.vega-embed .chart-wrapper { @apply h-auto !important; }
/* fixes fraction separators being overridden by tw’s border-color */
.katex * { @apply border-black; }

@media print {
    .dark-mode-toggle,
    .toc-toggle { @apply hidden; }
    .notebook-viewer { @apply pt-0; font-size: 12pt !important; margin-left: 0 !important; }
    .code-viewer .cm-content,
    .viewer-code .cm-content { @apply whitespace-pre-wrap !important; overflow: none; }
    .code-viewer .cm-line { font-size: 12pt !important; }
    html * { page-break-inside: avoid !important; }
    .toc-panel { @apply hidden; }
}
</style><script src="https://storage.clerk.garden/nextjournal/clerk-assets@4NdW4yYfmUzzw9xCkmyrJ75nH75d/viewer.js?immutable=true" type="module"></script><link href="https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css" rel="stylesheet" type="text/css"><link href="https://fonts.bunny.net" rel="preconnect"><link href="https://fonts.bunny.net/css?family=fira-mono:400,700%7Cfira-sans:400,400i,500,500i,700,700i%7Cfira-sans-condensed:700,700i%7Cpt-serif:400,400i,700,700i" rel="stylesheet" type="text/css"></head><body><div id="clerk-static-app"></div><script type="module">let state = "{:out-path \"public/build\", :path->doc {\"src/emmy/simplify/rules.cljc\" {:path [], :nextjournal/value {:toc {:type :toc, :children [{:children [{:type :toc, :content [{:type :text, :text \"Simplifier Configuration Variables\"}], :heading-level 2, :attrs {:id \"simplifier-configuration-variables\"}, :path [:content 0]} {:type :toc, :content [{:type :text, :text \"Binding Predicates\"}], :heading-level 2, :attrs {:id \"binding-predicates\"}, :path [:content 2]} {:type :toc, :content [{:type :text, :text \"Rule Sets\"}], :heading-level 2, :attrs {:id \"rule-sets\"}, :path [:content 4]} {:type :toc, :content [{:type :text, :text \"Square Root Simplification\"}], :heading-level 2, :attrs {:id \"square-root-simplification\"}, :path [:content 5]} {:type :toc, :content [{:type :text, :text \"Log / Exp\"}], :heading-level 2, :attrs {:id \"log-/-exp\"}, :path [:content 6]} {:type :toc, :content [{:type :text, :text \"Partials\"}], :heading-level 2, :attrs {:id \"partials\"}, :path [:content 7]} {:type :toc, :content [{:type :text, :text \"Trigonometric Rules\"}], :heading-level 2, :attrs {:id \"trigonometric-rules\"}, :path [:content 8]}], :type :toc}]}, :sidenotes? false, :toc-visibility true, :atom-var-name->state #viewer-eval (nextjournal.clerk.render/intern-atoms! {}), :ns #viewer-eval (ns emmy.simplify.rules), :auto-expand-results? nil, :scope emmy.simplify.rules, :bundle? false, :open-graph {:type \"article:clerk\", :title \"Simplifier Configuration Variables\", :description \"Emmy uses a number of dynamic variables to tune the behavior of the simplifier without having to thread explicit maps of options through the rulesets. This design is not optimal; in a future version, we'll move any rules that depend on these out to their own rulesets, and move the configuration variables over to [[emmy.simplify]].\"}, :title \"Simplifier Configuration Variables\", :blocks [{:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"emmy.simplify.rules/markdown-5drp3ACqq3L6dYME7mqrkSJRrTZggd\"} [\"h2\" {:id \"simplifier-configuration-variables\"} [:<> \"Simplifier Configuration Variables\"]] [:p [:<> \"Emmy uses a number of dynamic variables to tune the behavior of the\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"simplifier without having to thread explicit maps of options through the\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"rulesets. This design is not optimal; in a future version, we'll move any\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"rules that depend on these out to their own rulesets, and move the\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"configuration variables over to [[emmy.simplify]].\"]]], :nextjournal/opts {:id \"emmy.simplify.rules/markdown-5drp3ACqq3L6dYME7mqrkSJRrTZggd\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-with-react-key, :hash \"5drtFhRgc8WMLrXw6DB4bZLsNZjHHp\"}} {:path [], :nextjournal/value \"(def ^:dynamic *log-exp-simplify?*\\n  \\\"If true, allows the following simplification to proceed:\\n\\n  ```clojure\\n  (log (exp x)) => x.\\n  ```\\n\\n  Because `exp(i*x) == exp(i*(x+n*2pi))` for all integral `n`, this setting can\\n  confuse `x` with `x+n*2pi`.\\\"\\n  true)\", :nextjournal/opts {:id \"emmy.simplify.rules/*log-exp-simplify?*-code\", :loc {:line 39, :end-line 48, :column 1, :end-column 8}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value true, :nextjournal/opts {:id \"emmy.simplify.rules/*log-exp-simplify?*-result\"}, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-bool.inspected-value (str x)]), :hash \"5dtraRr8bAXanTgfMAzv3Q82Eguw7J\"}}, :nextjournal/blob-id \"5dscqVKTvbwKyMEi1RdKuCWqoDPM9A\"}, :nextjournal/opts {:id \"emmy.simplify.rules/*log-exp-simplify?*-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def ^:dynamic *exponent-product-simplify?*\\n  \\\"Allows `(x^a)^b => x^(a*b)`.\\n\\n  This is dangerous, because a root can be gained or lost:\\n\\n  ```\\n  x = (x^(1/2))^2 != ((x^2)^1/2)=+-x\\n  ```\\\"\\n  true)\", :nextjournal/opts {:id \"emmy.simplify.rules/*exponent-product-simplify?*-code\", :loc {:line 50, :end-line 58, :column 1, :end-column 8}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value true, :nextjournal/opts {:id \"emmy.simplify.rules/*exponent-product-simplify?*-result\"}, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-bool.inspected-value (str x)]), :hash \"5dtraRr8bAXanTgfMAzv3Q82Eguw7J\"}}, :nextjournal/blob-id \"5drXjkZeZ6YctAuPXiPWsyCtxuQ7f2\"}, :nextjournal/opts {:id \"emmy.simplify.rules/*exponent-product-simplify?*-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def ^:dynamic *expt-half->sqrt?*\\n  \\\" Traditionally, `sqrt(x)` is the positive square root, but `x^(1/2)` is both\\n  positive and negative roots.\\n\\n  Setting [[*expt-half->sqrt?*]] to `true` maps `x^(1/2)` to `sqrt(x)`,\\n  potentially losing a root.\\\"\\n  true)\", :nextjournal/opts {:id \"emmy.simplify.rules/*expt-half->sqrt?*-code\", :loc {:line 60, :end-line 66, :column 1, :end-column 8}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value true, :nextjournal/opts {:id \"emmy.simplify.rules/*expt-half->sqrt?*-result\"}, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-bool.inspected-value (str x)]), :hash \"5dtraRr8bAXanTgfMAzv3Q82Eguw7J\"}}, :nextjournal/blob-id \"5dsSmHDr71Lhyhh5fvMQQYG42fJ2V3\"}, :nextjournal/opts {:id \"emmy.simplify.rules/*expt-half->sqrt?*-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def ^:dynamic *sqrt-expt-simplify?*\\n  \\\"If x is real, then `(sqrt (square x)) = (abs x)`.\\n\\n  Setting [[*sqrt-expt-simplify?*]] to `true` allows `(sqrt (square x)) = x`,\\n  potentially causing a problem if `x` is in fact negative.\\\"\\n  true)\", :nextjournal/opts {:id \"emmy.simplify.rules/*sqrt-expt-simplify?*-code\", :loc {:line 68, :end-line 73, :column 1, :end-column 8}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value true, :nextjournal/opts {:id \"emmy.simplify.rules/*sqrt-expt-simplify?*-result\"}, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-bool.inspected-value (str x)]), :hash \"5dtraRr8bAXanTgfMAzv3Q82Eguw7J\"}}, :nextjournal/blob-id \"5duFoq4fnZJ7w2VsbreistuqUBvAx5\"}, :nextjournal/opts {:id \"emmy.simplify.rules/*sqrt-expt-simplify?*-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def ^:dynamic *sqrt-factor-simplify?*\\n  \\\"If `x` and `y` are real and non-negative, then\\n\\n  ```\\n  (* (sqrt x) (sqrt y)) = (sqrt (* x y))\\n  ```\\n\\n  This is not true for negative factors. Setting [[*sqrt-factor-simplify?*]] to\\n  true enables this simplification, causing a problem if `x` or `y` are in fact\\n  negative.\\\"\\n  true)\", :nextjournal/opts {:id \"emmy.simplify.rules/*sqrt-factor-simplify?*-code\", :loc {:line 75, :end-line 85, :column 1, :end-column 8}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value true, :nextjournal/opts {:id \"emmy.simplify.rules/*sqrt-factor-simplify?*-result\"}, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-bool.inspected-value (str x)]), :hash \"5dtraRr8bAXanTgfMAzv3Q82Eguw7J\"}}, :nextjournal/blob-id \"5dtNXPQJLputh1srCmAnU6ycYqtY6y\"}, :nextjournal/opts {:id \"emmy.simplify.rules/*sqrt-factor-simplify?*-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def ^:dynamic *aggressive-atan-simplify?*\\n  \\\"When `true`, allows:\\n\\n  ```\\n  (atan y x) => (atan (/ y d) (/ x d))\\n  ```\\n\\n  where `d=(gcd x y)`.\\n\\n  This is fine if `d` is a number (Numeric `gcd` is always positive), but may lose\\n  quadrant information if `d` is a symbolic expression that can be negative for\\n  some values of its variables.\\\"\\n  true)\", :nextjournal/opts {:id \"emmy.simplify.rules/*aggressive-atan-simplify?*-code\", :loc {:line 87, :end-line 99, :column 1, :end-column 8}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value true, :nextjournal/opts {:id \"emmy.simplify.rules/*aggressive-atan-simplify?*-result\"}, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-bool.inspected-value (str x)]), :hash \"5dtraRr8bAXanTgfMAzv3Q82Eguw7J\"}}, :nextjournal/blob-id \"5dsZnz72cvQ6ECPrzPV7ZPJTAEPZaR\"}, :nextjournal/opts {:id \"emmy.simplify.rules/*aggressive-atan-simplify?*-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def ^:dynamic *inverse-simplify?*\\n  \\\"When `true`, allows trigonometric inverse functions to simplify:\\n\\n  ```\\n  (asin (sin x)) => x\\n  ```\\n\\n  Because trigonometric functions like `sin` and `cos` are cyclic, this can lose\\n  multi-value info (as with [[*log-exp-simplify*]]).\\\"\\n  true)\", :nextjournal/opts {:id \"emmy.simplify.rules/*inverse-simplify?*-code\", :loc {:line 101, :end-line 110, :column 1, :end-column 8}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value true, :nextjournal/opts {:id \"emmy.simplify.rules/*inverse-simplify?*-result\"}, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-bool.inspected-value (str x)]), :hash \"5dtraRr8bAXanTgfMAzv3Q82Eguw7J\"}}, :nextjournal/blob-id \"5dr6cPvHfmB83efdLBdj4Gjpj3QcJx\"}, :nextjournal/opts {:id \"emmy.simplify.rules/*inverse-simplify?*-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def ^:dynamic *sin-cos-simplify?*\\n  \\\"When `true`, allows arguments of `sin`, `cos` and `tan` that are\\n  rational multiples of `'pi` to be reduced. See [[trig:special]] for these\\n  rules.\\\"\\n  true)\", :nextjournal/opts {:id \"emmy.simplify.rules/*sin-cos-simplify?*-code\", :loc {:line 112, :end-line 116, :column 1, :end-column 8}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value true, :nextjournal/opts {:id \"emmy.simplify.rules/*sin-cos-simplify?*-result\"}, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-bool.inspected-value (str x)]), :hash \"5dtraRr8bAXanTgfMAzv3Q82Eguw7J\"}}, :nextjournal/blob-id \"5dtBaWognbxs1rJk5WVfuhQMityDMu\"}, :nextjournal/opts {:id \"emmy.simplify.rules/*sin-cos-simplify?*-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def ^:dynamic *half-angle-simplify?*\\n  \\\"When `true`, enables the half-angle reductions described in [[half-angle]].\\n\\n  Note from GJS: 'Sign of result is hairy!'\\\"\\n  true)\", :nextjournal/opts {:id \"emmy.simplify.rules/*half-angle-simplify?*-code\", :loc {:line 118, :end-line 122, :column 1, :end-column 8}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value true, :nextjournal/opts {:id \"emmy.simplify.rules/*half-angle-simplify?*-result\"}, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-bool.inspected-value (str x)]), :hash \"5dtraRr8bAXanTgfMAzv3Q82Eguw7J\"}}, :nextjournal/blob-id \"5drwkSMiZr1njps7VayXVCowJ7nisd\"}, :nextjournal/opts {:id \"emmy.simplify.rules/*half-angle-simplify?*-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def ^:dynamic *commute-partials?*\\n  \\\"When true, allows commutation of partial derivatives so that partial\\n  derivatives appear in order.\\n\\n  For example:\\n\\n  ```clojure\\n  (((* (partial 2 1) (partial 1 1)) FF) (up t (up x y) (down p_x p_y)))\\n  ```\\n\\n  Since the partial indices in the outer derivative are lexically greater than\\n  those of the inner, we canonicalize by swapping the order:\\n\\n  ```clojure\\n  (((* (partial 1 1) (partial 2 1)) FF) (up t (up x y) (down p_x p_y)))\\n  ```\\n\\n  When the components selected by the partials are unstructured (e.g. real),\\n  this is okay due to the 'equality of mixed partials'.\\\"\\n  true)\", :nextjournal/opts {:id \"emmy.simplify.rules/*commute-partials?*-code\", :loc {:line 124, :end-line 143, :column 1, :end-column 8}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value true, :nextjournal/opts {:id \"emmy.simplify.rules/*commute-partials?*-result\"}, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-bool.inspected-value (str x)]), :hash \"5dtraRr8bAXanTgfMAzv3Q82Eguw7J\"}}, :nextjournal/blob-id \"5dshL24Yu9piPSdk4j3RXG5ugLU5fa\"}, :nextjournal/opts {:id \"emmy.simplify.rules/*commute-partials?*-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def ^:dynamic *divide-numbers-through-simplify?*\\n  \\\"When `true`, allows division through the numerator by numbers in the\\n  denominator:\\n\\n  ```\\n  (/ (+ (* 4 x) 5) 3) => (+ (* 4/3 x) 5/3)\\n  ```\\n\\n  This setting is `true` by default.\\\"\\n  true)\", :nextjournal/opts {:id \"emmy.simplify.rules/*divide-numbers-through-simplify?*-code\", :loc {:line 145, :end-line 154, :column 1, :end-column 8}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value true, :nextjournal/opts {:id \"emmy.simplify.rules/*divide-numbers-through-simplify?*-result\"}, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-bool.inspected-value (str x)]), :hash \"5dtraRr8bAXanTgfMAzv3Q82Eguw7J\"}}, :nextjournal/blob-id \"5dsJNTubi8rXkaXGDAjosBZYsiGtp3\"}, :nextjournal/opts {:id \"emmy.simplify.rules/*divide-numbers-through-simplify?*-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def ^:dynamic *trig-product-to-sum-simplify?*\\n  \\\"Transforms products of trig functions into functions of sums of angles.\\n\\n  For example:\\n\\n  ```\\n  (* (sin x) (cos y))\\n  ;;=>\\n  (+ (* 1/2 (sin (+ x y)))\\n    (* 1/2 (sin (+ x (* -1 y)))) )\\n  ```\\\"\\n  false)\", :nextjournal/opts {:id \"emmy.simplify.rules/*trig-product-to-sum-simplify?*-code\", :loc {:line 156, :end-line 167, :column 1, :end-column 9}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value false, :nextjournal/opts {:id \"emmy.simplify.rules/*trig-product-to-sum-simplify?*-result\"}, :nextjournal/viewer {:render-fn #viewer-fn (fn [x] [:span.cmt-bool.inspected-value (str x)]), :hash \"5dtraRr8bAXanTgfMAzv3Q82Eguw7J\"}}, :nextjournal/blob-id \"5duBhqow7JrU4hJvozNxuJy5sjmhWZ\"}, :nextjournal/opts {:id \"emmy.simplify.rules/*trig-product-to-sum-simplify?*-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"emmy.simplify.rules/markdown-5duGAzaeFEhJiCEcCbMVxobidUggpw\"} [\"h2\" {:id \"binding-predicates\"} [:<> \"Binding Predicates\"]] [:p [:<> \"The following predicates are used to restrict bindings in the rules that\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"follow. Bindings can take multiple predicates, but it reads a bit better to\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"have them tightened up into a single predicate.\"]]], :nextjournal/opts {:id \"emmy.simplify.rules/markdown-5duGAzaeFEhJiCEcCbMVxobidUggpw\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-with-react-key, :hash \"5drtFhRgc8WMLrXw6DB4bZLsNZjHHp\"}} {:path [], :nextjournal/value \"(defn negative-number? [x]\\n  (and (v/number? x)\\n       (g/negative? x)))\", :nextjournal/opts {:id \"emmy.simplify.rules/negative-number?-code\", :loc {:line 175, :end-line 177, :column 1, :end-column 25}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$negative_number_QMARK_ 0x83c6967 \\\"emmy.simplify.rules$negative_number_QMARK_@83c6967\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/negative-number?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/negative-number?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn- imaginary-number?\\n  \\\"Returns true if `z` is a complex number with nonzero imaginary part and zero\\n  real part, false otherwise.\\\"\\n  [z]\\n  (and (c/complex? z)\\n       (not (v/zero? z))\\n       (v/zero? (g/real-part z))))\", :nextjournal/opts {:id \"emmy.simplify.rules/imaginary-number?-code\", :loc {:line 179, :end-line 185, :column 1, :end-column 35}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$imaginary_number_QMARK_ 0x635f0f69 \\\"emmy.simplify.rules$imaginary_number_QMARK_@635f0f69\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/imaginary-number?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/imaginary-number?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn- complex-number?\\n  \\\"Returns true if `z` is a complex number with nonzero real AND imaginary parts,\\n  false otherwise.\\\"\\n  [z]\\n  (and (c/complex? z)\\n       (not (v/zero? (g/real-part z)))\\n       (not (v/zero? (g/imag-part z)))))\", :nextjournal/opts {:id \"emmy.simplify.rules/complex-number?-code\", :loc {:line 187, :end-line 193, :column 1, :end-column 41}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$complex_number_QMARK_ 0xd791159 \\\"emmy.simplify.rules$complex_number_QMARK_@d791159\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/complex-number?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/complex-number?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn- imaginary-integer?\\n  \\\"Returns true if `z` is an imaginary number with an integral (or VERY close to\\n  integral) imaginary part, false otherwise.\\\"\\n  [z]\\n  (and (imaginary-number? z)\\n       (v/almost-integral?\\n        (g/imag-part z))))\", :nextjournal/opts {:id \"emmy.simplify.rules/imaginary-integer?-code\", :loc {:line 195, :end-line 201, :column 1, :end-column 27}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$imaginary_integer_QMARK_ 0x3d304efa \\\"emmy.simplify.rules$imaginary_integer_QMARK_@3d304efa\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/imaginary-integer?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/imaginary-integer?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn not-integral? [x]\\n  (not (v/integral? x)))\", :nextjournal/opts {:id \"emmy.simplify.rules/not-integral?-code\", :loc {:line 203, :end-line 204, :column 1, :end-column 25}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$not_integral_QMARK_ 0x562c6f6a \\\"emmy.simplify.rules$not_integral_QMARK_@562c6f6a\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/not-integral?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/not-integral?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn even? [x]\\n  (v/zero? (g/modulo x 2)))\", :nextjournal/opts {:id \"emmy.simplify.rules/even?-code\", :loc {:line 206, :end-line 207, :column 1, :end-column 28}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$even_QMARK_ 0x4d930681 \\\"emmy.simplify.rules$even_QMARK_@4d930681\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/even?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/even?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn odd? [x]\\n  (v/one? (g/modulo x 2)))\", :nextjournal/opts {:id \"emmy.simplify.rules/odd?-code\", :loc {:line 209, :end-line 210, :column 1, :end-column 27}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$odd_QMARK_ 0x82535b3 \\\"emmy.simplify.rules$odd_QMARK_@82535b3\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/odd?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/odd?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn- even-integer? [x]\\n  (and (v/integral? x)\\n       (even? x)))\", :nextjournal/opts {:id \"emmy.simplify.rules/even-integer?-code\", :loc {:line 212, :end-line 214, :column 1, :end-column 19}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$even_integer_QMARK_ 0x37ddfdd3 \\\"emmy.simplify.rules$even_integer_QMARK_@37ddfdd3\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/even-integer?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/even-integer?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn odd-integer? [x]\\n  (and (v/integral? x)\\n       (odd? x)))\", :nextjournal/opts {:id \"emmy.simplify.rules/odd-integer?-code\", :loc {:line 216, :end-line 218, :column 1, :end-column 18}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$odd_integer_QMARK_ 0x2bf937d \\\"emmy.simplify.rules$odd_integer_QMARK_@2bf937d\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/odd-integer?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/odd-integer?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn odd-positive-integer? [x]\\n  (and (odd-integer? x)\\n       (> x 2)))\", :nextjournal/opts {:id \"emmy.simplify.rules/odd-positive-integer?-code\", :loc {:line 220, :end-line 222, :column 1, :end-column 17}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$odd_positive_integer_QMARK_ 0x574d3aa5 \\\"emmy.simplify.rules$odd_positive_integer_QMARK_@574d3aa5\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/odd-positive-integer?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/odd-positive-integer?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn- more-than-two? [x]\\n  (and (v/number? x) (> x 2)))\", :nextjournal/opts {:id \"emmy.simplify.rules/more-than-two?-code\", :loc {:line 224, :end-line 225, :column 1, :end-column 31}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$more_than_two_QMARK_ 0x76641552 \\\"emmy.simplify.rules$more_than_two_QMARK_@76641552\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/more-than-two?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/more-than-two?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn- at-least-two? [x]\\n  (and (v/number? x) (>= x 2)))\", :nextjournal/opts {:id \"emmy.simplify.rules/at-least-two?-code\", :loc {:line 227, :end-line 228, :column 1, :end-column 32}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$at_least_two_QMARK_ 0x2e8f5d28 \\\"emmy.simplify.rules$at_least_two_QMARK_@2e8f5d28\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/at-least-two?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/at-least-two?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"emmy.simplify.rules/markdown-5duL2q7HFcdQ7McGX8MYKPXRa9FPzr\"} [\"h2\" {:id \"rule-sets\"} [:<> \"Rule Sets\"]]], :nextjournal/opts {:id \"emmy.simplify.rules/markdown-5duL2q7HFcdQ7McGX8MYKPXRa9FPzr\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-with-react-key, :hash \"5drtFhRgc8WMLrXw6DB4bZLsNZjHHp\"}} {:path [], :nextjournal/value \"(defn unary-elimination\\n  \\\"Takes a sequence `ops` of operator symbols like `'+`, `'*` and returns a rule\\n  that strips these operations off of unary applications.\\n\\n  ```clojure\\n  (let [rule (unary-elimination '+ '*)\\n        f    (rule-simplifier rule)]\\n    (f '(+ x y (* z) (+ a))))\\n  ;;=> (+ x y z a)\\n  ```\\\"\\n  [& ops]\\n  (let [op-set (into #{} ops)]\\n    (ruleset\\n     ((? _ op-set) ?x) => ?x)))\", :nextjournal/opts {:id \"emmy.simplify.rules/unary-elimination-code\", :loc {:line 232, :end-line 245, :column 1, :end-column 32}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$unary_elimination 0x505507ff \\\"emmy.simplify.rules$unary_elimination@505507ff\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/unary-elimination-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/unary-elimination-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn constant-elimination\\n  \\\"Takes an operator symbol `op` and an identity element `constant` and returns a\\n  rule that eliminates instances of `constant` inside any-arity forms like\\n\\n  ```clojure\\n  (<op> ,,,args,,,)\\n  ```\\\"\\n  [op constant]\\n  (ruleset\\n   (~op ??xs)\\n   => (~op (?? (fn [{xs '??xs}]\\n                 (remove #{constant} xs))))))\", :nextjournal/opts {:id \"emmy.simplify.rules/constant-elimination-code\", :loc {:line 247, :end-line 258, :column 1, :end-column 46}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$constant_elimination 0x6ef39742 \\\"emmy.simplify.rules$constant_elimination@6ef39742\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/constant-elimination-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/constant-elimination-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn constant-promotion\\n  \\\"Takes an operator symbol `op` and an identity element `constant` and returns a\\n  rule that turns binary forms with `constant` on either side into `constant`.\\n\\n  This rule is useful for commutative annihilators like:\\n\\n  ```clojure\\n  (* 0 <anything>) => 0\\n  (and false <anything>) => false\\n  (or true <anything>) => true\\n  ```\\\"\\n  [op constant]\\n  (ruleset\\n   (~op _ ~constant) => ~constant\\n   (~op ~constant _) => ~constant))\", :nextjournal/opts {:id \"emmy.simplify.rules/constant-promotion-code\", :loc {:line 260, :end-line 274, :column 1, :end-column 36}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$constant_promotion 0x38ebc14b \\\"emmy.simplify.rules$constant_promotion@38ebc14b\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/constant-promotion-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/constant-promotion-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn associative\\n  \\\"Takes any number of operator symbols `ops` like `'+`, `'*` and returns a rule\\n  that collapses nested applications of each operation into a single\\n  sequence. (The associative property lets us strip parentheses.)\\n\\n  ```clojure\\n  (let [rule (associative '+ '*)\\n        f    (rule-simplifier rule)]\\n    (= (+ x y z a (* b c d) cake face)\\n       (f '(+ x (+ y (+ z a) (* b (* c d))\\n                   (+ cake face))))))\\n  ```\\\"\\n  [& ops]\\n  (let [op-set  (into #{} ops)\\n        flatten (fn [op]\\n                  (r/ruleset\\n                   (~op ??xs) => [??xs]\\n                   ?x         => [?x]))]\\n    (ruleset\\n     ((? ?op op-set) ??a (?op ??b) ??c)\\n     =>\\n     (?op ??a (?? (fn [{op '?op, b '??b, c '??c}]\\n                    (mapcat (flatten op)\\n                            (concat b c))))))))\", :nextjournal/opts {:id \"emmy.simplify.rules/associative-code\", :loc {:line 276, :end-line 299, :column 1, :end-column 48}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$associative 0x6cd9bd63 \\\"emmy.simplify.rules$associative@6cd9bd63\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/associative-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/associative-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn commutative\\n  \\\"Takes any number of operator symbols `ops` like `'+`, `'*` and returns a rule\\n  that sorts the argument list of any multiple-arity call to any of the supplied\\n  operators. Sorting is accomplished with [[emmy.expression/sort]].\\n\\n  For example:\\n\\n  ```clojure\\n  (let [rule (commutative '* '+)]\\n    (= '(* 2 3 a b c (+ c a b))\\n       (rule '(* c a b (+ c a b) 3 2))))\\n  ```\\\"\\n  [& ops]\\n  (let [op-set (into #{} ops)]\\n    (ruleset\\n     ((? ?op op-set) ??xs)\\n     => (?op (?? #(x/sort (% '??xs)))))))\", :nextjournal/opts {:id \"emmy.simplify.rules/commutative-code\", :loc {:line 301, :end-line 317, :column 1, :end-column 42}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$commutative 0x14cb25f8 \\\"emmy.simplify.rules$commutative@14cb25f8\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/commutative-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/commutative-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn idempotent\\n  \\\"Returns a simplifier that will remove consecutive duplicate arguments to any\\n  of the operations supplied as `ops`. Acts as identity otherwise.\\n\\n  ```clojure\\n  (let [rule (idempotent 'and)]\\n    (= '(and a b c d)\\n       (rule '(and a b b c c c d))))\\n  ```\\\"\\n  [& ops]\\n  (let [op-set (into #{} ops)]\\n    (ruleset\\n     ((? ?op op-set) ??pre ?x ?x ??post)\\n     =>\\n     (?op (?? (fn [m]\\n                (dedupe\\n                 (r/template\\n                  m (??pre ?x ??post)))))))))\", :nextjournal/opts {:id \"emmy.simplify.rules/idempotent-code\", :loc {:line 319, :end-line 336, :column 1, :end-column 46}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$idempotent 0x66f0e9a4 \\\"emmy.simplify.rules$idempotent@66f0e9a4\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/idempotent-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/idempotent-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def exponent-contract\\n  \\\"Set of rules that collect adjacent products, exponents and nested exponents\\n  into exponent terms.\\\"\\n  (ruleset\\n   ;; nested exponent case.\\n   (expt (expt ?op (? ?n v/integral?))\\n         (? ?m v/integral?))\\n   => (expt ?op (? #(g/+ (% '?n) (% '?m))))\\n\\n   ;; adjacent pairs of exponents\\n   (* ??pre\\n      (expt ?op (? ?n v/integral?))\\n      (expt ?op (? ?m v/integral?))\\n      ??post)\\n   => (* ??pre\\n         (expt ?op (? #(g/+ (% '?n) (% '?m))))\\n         ??post)\\n\\n   ;; exponent on right, non-expt on left\\n   (* ??pre\\n      ?op (expt ?op (? ?n v/integral?))\\n      ??post)\\n   => (* ??pre\\n         (expt ?op (? #(g/+ (% '?n) 1)))\\n         ??post)\\n\\n   ;; exponent on left, non-expt on right\\n   (* ??pre\\n      (expt ?op (? ?n v/integral?)) ?op\\n      ??post)\\n   => (* ??pre\\n         (expt ?op (? #(g/+ (% '?n) 1)))\\n         ??post)\\n\\n   ;; non-exponent pairs\\n   (* ??pre ?op ?op ??post)\\n   => (* ??pre (expt ?op 2) ??post)))\", :nextjournal/opts {:id \"emmy.simplify.rules/exponent-contract-code\", :loc {:line 338, :end-line 374, :column 1, :end-column 38}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.pattern.rule$choice_STAR_$fn__77846 0x779da8 \\\"emmy.pattern.rule$choice_STAR_$fn__77846@779da8\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/exponent-contract-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/exponent-contract-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn logexp\\n  \\\"Returns a rule simplifier that attempts to simplify nested exp and log forms.\\n\\n  You can tune the behavior of this simplifier with [[*log-exp-simplify?*]]\\n  and [[*sqrt-expt-simplify?*]].\\n\\n  NOTE: [[logexp]] returns a `rule-simplifier`, which memoizes its traversal\\n  through the supplied expression. This means that if you try to\\n  customize [[logexp]] with dynamic binding variables AFTER passing an\\n  expression into it, you may get a memoized result which used the previous\\n  dynamic binding.\\n\\n  This is a problem we should address!\\\"\\n  [simplify]\\n  (rule-simplifier\\n   (r/ruleset*\\n    (r/rule\\n     (exp (* (? ?n v/integral?) (log ?x)))\\n     => (expt ?x ?n))\\n\\n    (r/rule\\n     (exp (log ?x)) => ?x)\\n\\n    (r/guard\\n     (fn [_] *log-exp-simplify?*)\\n     (r/rule\\n      (log (exp ?x))\\n      (fn [{x '?x}]\\n        (let [xs (simplify x)]\\n          (and (ul/assume!\\n                (r/template\\n                 (= (log (exp ~xs)) ~xs))\\n                'logexp1)\\n               x)))))\\n\\n    (r/guard\\n     (fn [_] *sqrt-expt-simplify?*)\\n     (r/rule (sqrt (exp ?x))\\n             (fn [{x '?x}]\\n               (let [xs (simplify x)]\\n                 (and (ul/assume!\\n                       (r/template\\n                        (= (sqrt (exp ~xs))\\n                           (exp (/ ~xs 2))))\\n                       'logexp2)\\n                      (r/template (exp (/ ~x 2))))))))\\n\\n    (r/rule\\n     (log (sqrt ?x)) => (* (/ 1 2) (log ?x))))))\", :nextjournal/opts {:id \"emmy.simplify.rules/logexp-code\", :loc {:line 376, :end-line 424, :column 1, :end-column 49}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$logexp 0x21e40a60 \\\"emmy.simplify.rules$logexp@21e40a60\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/logexp-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/logexp-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def magnitude\\n  \\\"Rule simplifier for forms that contain `magnitude` entries.\\\"\\n  (rule-simplifier\\n   (ruleset\\n    (magnitude (? ?n v/real?))\\n    => (? (comp g/magnitude '?n))\\n\\n    (magnitude (* ??xs))\\n    => (* (?? (fn [{xs '??xs}]\\n                (map #(list 'magnitude %)\\n                     xs))))\\n\\n    (magnitude (expt ?x 1))\\n    => (magnitude ?x)\\n\\n    (magnitude (expt ?x (? ?n even-integer?)))\\n    => (expt ?x ?n)\\n\\n    (magnitude (expt ?x (? ?n v/integral?)))\\n    => (* (magnitude ?x) (expt ?x (? #(g/- (% '?n) 1)))))))\", :nextjournal/opts {:id \"emmy.simplify.rules/magnitude-code\", :loc {:line 426, :end-line 445, :column 1, :end-column 60}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0x6c4d1f41 \\\"clojure.lang.AFunction$1@6c4d1f41\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/magnitude-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/magnitude-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn miscsimp\\n  \\\"Simplifications for various exponent forms (assuming commutative multiplication).\\n\\n  NOTE that we have some similarities to [[exponent-contract]] above - that\\n  function works for non-commutative multiplication - AND that this needs a new\\n  name.\\\"\\n  [simplify]\\n  (let [sym:* (sym/symbolic-operator '*)]\\n    (rule-simplifier\\n     (ruleset\\n      (expt _ 0)  => 1\\n      (expt ?x 1) => ?x\\n\\n      ;; e^{ni} == 0,i,-1 or -i.\\n      (expt ~c/I (? ?n v/integral?))\\n      => (? #([1 c/I -1 (g/- c/I)]\\n              (mod (% '?n) 4)))\\n\\n      (expt (expt ?x ?a) ?b)\\n      (fn [{a '?a b '?b x '?x}]\\n        (let [as (simplify a)\\n              bs (simplify b)]\\n          (when (or (and (v/integral? as)\\n                         (v/integral? bs))\\n\\n                    (and (even-integer? bs)\\n                         (v/integral?\\n                          (simplify (sym:* as bs))))\\n\\n                    (and *exponent-product-simplify?*\\n                         (ul/assume!\\n                          (r/template\\n                           (= (expt (expt ~x ~as) ~bs)\\n                              (expt ~x ~(sym:* as bs))))\\n                          'exponent-product)))\\n            {'?ab (g/* a b)})))\\n      (expt ?x ?ab)\\n\\n      (expt ?x (/ 1 2))\\n      (fn [_] *expt-half->sqrt?*)\\n      (sqrt ?x)\\n\\n      ;; Collect duplicate terms into exponents.\\n      ;;\\n      ;; TODO this is missing the case where non-exponent duplicates get\\n      ;; collected into exponents. At least note this; in the current library,\\n      ;; like terms are collected by the polynomial simplifier.\\n      ;;\\n      ;; GJS notes: \\\"a rare, expensive luxury.\\\"\\n      (* ??fs1* ?x ??fs2 (expt ?x ?y) ??fs3)\\n      => (* ??fs1 ??fs2 (expt ?x (+ 1 ?y)) ??fs3)\\n\\n      (* ??fs1 (expt ?x ?y) ??fs2 ?x ??fs3)\\n      => (* ??fs1 (expt ?x (+ 1 ?y)) ??fs2 ??fs3)\\n\\n      (* ??fs1 (expt ?x ?y1) ??fs2 (expt ?x ?y2) ??fs3)\\n      => (* ??fs1 ??fs2 (expt ?x (+ ?y1 ?y2)) ??fs3)))))\", :nextjournal/opts {:id \"emmy.simplify.rules/miscsimp-code\", :loc {:line 447, :end-line 503, :column 1, :end-column 57}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$miscsimp 0xd1176a5 \\\"emmy.simplify.rules$miscsimp@d1176a5\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/miscsimp-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/miscsimp-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"emmy.simplify.rules/markdown-5duD3mwQZLLpt7Sp9ZP1MKUPFW3MJr\"} [\"h2\" {:id \"square-root-simplification\"} [:<> \"Square Root Simplification\"]]], :nextjournal/opts {:id \"emmy.simplify.rules/markdown-5duD3mwQZLLpt7Sp9ZP1MKUPFW3MJr\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-with-react-key, :hash \"5drtFhRgc8WMLrXw6DB4bZLsNZjHHp\"}} {:path [], :nextjournal/value \"(defn simplify-square-roots [simplify]\\n  (rule-simplifier\\n   (r/rule\\n    (expt (sqrt ?x) (? ?n even-integer?))\\n    => (expt ?x (? #(g// (% '?n) 2))))\\n\\n   ;; TODO verify that these trigger and that the simplifier passes them\\n   ;; correctly.\\n   (r/ruleset*\\n    (r/guard\\n     (fn [_] *sqrt-expt-simplify?*)\\n     (r/ruleset*\\n      (r/rule\\n       (sqrt (expt ?x (? ?n even-integer?)))\\n       (fn [{x '?x n '?n}]\\n         (let [xs (simplify x)\\n               half-n (g// n 2)]\\n           (when (ul/assume!\\n                  (r/template\\n                   (= (sqrt (expt ~xs ~n))\\n                      (expt ~xs ~half-n)))\\n                  'simsqrt1)\\n             {'?new-n half-n})))\\n       (expt ?x ?new-n))\\n\\n      (r/rule\\n       (sqrt (expt ?x (? ?n odd-positive-integer?)))\\n       (fn [{x '?x n '?n}]\\n         (let [xs (simplify x)\\n               half-dec-n (g// (g/- n 1) 2)]\\n           (when (ul/assume!\\n                  (r/template\\n                   (= (sqrt (expt ~xs ~n))\\n                      (expt ~xs ~half-dec-n)))\\n                  'simsqrt2)\\n             {'?new-n half-dec-n})))\\n       (* (sqrt ?x) (expt ?x ?new-n))))))\\n\\n   (ruleset\\n    (expt (sqrt ?x) (? ?n odd-integer?))\\n    => (* (sqrt ?x)\\n          (expt ?x (? #(g// (g/- (% '?n) 1) 2))))\\n\\n    (/ ?x (sqrt ?x)) => (sqrt ?x)\\n\\n    (/ (sqrt ?x) ?x) => (/ 1 (sqrt ?x))\\n\\n    (/ (* ??u ?x ??v) (sqrt ?x))\\n    =>\\n    (* ??u (sqrt ?x) ??v)\\n\\n    (/ (* ??u (sqrt ?x) ??v) ?x)\\n    =>\\n    (/ (* ??u ??v) (sqrt ?x))\\n\\n    (/ ?x (* ??u (sqrt ?x) ??v))\\n    =>\\n    (/ (sqrt ?x) (* ??u ??v))\\n\\n    (/ (sqrt ?x) (* ??u ?x ??v))\\n    =>\\n    (/ 1 (* ??u (sqrt ?x) ??v))\\n\\n    (/ (* ??p ?x ??q)\\n       (* ??u (sqrt ?x) ??v))\\n    =>\\n    (/ (* ??p (sqrt ?x) ??q)\\n       (* ??u ??v))\\n\\n    (/ (* ??p (sqrt ?x) ??q)\\n       (* ??u ?x ??v))\\n    =>\\n    (/ (* ??p ??q)\\n       (* ??u (sqrt ?x) ??v)))))\", :nextjournal/opts {:id \"emmy.simplify.rules/simplify-square-roots-code\", :loc {:line 507, :end-line 580, :column 1, :end-column 33}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$simplify_square_roots 0x31373072 \\\"emmy.simplify.rules$simplify_square_roots@31373072\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/simplify-square-roots-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/simplify-square-roots-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn non-negative-factors!\\n  \\\"Takes one or two simplified expressions `x` and `y` and a symbolic identifier\\n  `id` and registers an assumption that both sides are non-negative.\\n\\n  Returns the conjuction of both assumptions in the two argument case, or the\\n  single assumption in the one-argument case.\\\"\\n  ([x id]\\n   (ul/assume! `(~'non-negative? ~x) id (fn [] false)))\\n  ([x y id]\\n   (and (ul/assume! `(~'non-negative? ~x) id (fn [] false))\\n        (ul/assume! `(~'non-negative? ~y) id (fn [] false)))))\", :nextjournal/opts {:id \"emmy.simplify.rules/non-negative-factors!-code\", :loc {:line 582, :end-line 592, :column 1, :end-column 63}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$non_negative_factors_BANG_ 0x30019b3e \\\"emmy.simplify.rules$non_negative_factors_BANG_@30019b3e\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/non-negative-factors!-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/non-negative-factors!-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn sqrt-expand\\n  \\\"Returns a rule simplifier that distributes the radical sign across products and\\n  quotients. The companion rule [[sqrt-contract]] reassembles what remains.\\n\\n  NOTE that doing this may allow equal subexpressions within the radicals to\\n  cancel in various ways.\\n\\n  Turn this simplifier on and off with [[*sqrt-factor-simplify?*]].\\\"\\n  [simplify]\\n  (letfn [(pred [label]\\n            (fn [{x '?x y '?y}]\\n              (let [xs (simplify x)\\n                    ys (simplify y)]\\n                (if (v/= xs ys)\\n                  (non-negative-factors! xs label)\\n                  (non-negative-factors! xs ys label)))))]\\n    (r/attempt\\n     (r/guard\\n      (fn [_] *sqrt-factor-simplify?*)\\n      (rule-simplifier\\n       (ruleset\\n        (sqrt (* ?x ?y))\\n        (pred 'e1)\\n        (* (sqrt ?x) (sqrt ?y))\\n\\n        (sqrt (* ?x ?y ??ys))\\n        (pred 'e2)\\n        (* (sqrt ?x) (sqrt (* ?y ??ys)))\\n\\n        (sqrt (/ ?x ?y))\\n        (pred 'e3)\\n        (/ (sqrt ?x) (sqrt ?y))\\n\\n        (sqrt (/ ?x ?y ??ys))\\n        (pred 'e4)\\n        (/ (sqrt ?x) (sqrt (* ?y ??ys)))))))))\", :nextjournal/opts {:id \"emmy.simplify.rules/sqrt-expand-code\", :loc {:line 594, :end-line 629, :column 1, :end-column 47}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$sqrt_expand 0x34323d68 \\\"emmy.simplify.rules$sqrt_expand@34323d68\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/sqrt-expand-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/sqrt-expand-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn sqrt-contract [simplify]\\n  (rule-simplifier\\n   (r/ruleset*\\n    (r/rule\\n     (* ??a (sqrt ?x) ??b (sqrt ?y) ??c)\\n     (fn [{x '?x y '?y :as m}]\\n       (let [xs (simplify x)\\n             ys (simplify y)]\\n         (if (v/= xs ys)\\n           (and (non-negative-factors! xs 'c1)\\n                (r/template\\n                 m (* ??a ~xs ??b ??c)))\\n           (and (non-negative-factors! xs ys 'c1)\\n                (r/template\\n                 m (* ??a (sqrt (* ~xs ~ys)) ??b ??c)))))))\\n\\n    (r/rule\\n     (/ (sqrt ?x) (sqrt ?y))\\n     (fn [{x '?x y '?y}]\\n       (let [xs (simplify x)\\n             ys (simplify y)]\\n         (if (v/= xs ys)\\n           (and (non-negative-factors! xs 'c2)\\n                1)\\n           (and (non-negative-factors! xs ys 'c2)\\n                (r/template (sqrt (/ ~xs ~ys))))))))\\n\\n    (r/rule\\n     (/ (* ??a (sqrt ?x) ??b) (sqrt ?y))\\n     (fn [{x '?x y '?y :as m}]\\n       (let [xs (simplify x)\\n             ys (simplify y)]\\n         (if (v/= xs ys)\\n           (and (non-negative-factors! xs 'c3)\\n                (r/template m (* ??a ??b)))\\n           (and (non-negative-factors! xs ys 'c3)\\n                (r/template\\n                 m (* ??a (sqrt (/ ~xs ~ys)) ??b)))))))\\n\\n    (r/rule\\n     (/ (sqrt ?x) (* ??a (sqrt ?y) ??b))\\n     (fn [{x '?x y '?y :as m}]\\n       (let [xs (simplify x)\\n             ys (simplify y)]\\n         (if (v/= xs ys)\\n           (and (non-negative-factors! xs 'c4)\\n                (r/template m (/ 1 (* ??a ??b))))\\n           (and (non-negative-factors! xs ys 'c4)\\n                (r/template\\n                 m (/ (sqrt (/ ~xs ~ys))\\n                      (* ??a ??b))))))))\\n\\n    (r/rule\\n     (/ (* ??a (sqrt ?x) ??b)\\n        (* ??c (sqrt ?y) ??d))\\n     (fn [{x '?x y '?y :as m}]\\n       (let [xs (simplify x)\\n             ys (simplify y)]\\n         (if (v/= xs ys)\\n           (and (non-negative-factors! xs 'c5)\\n                (r/template\\n                 m (/ (* ??a ??b)\\n                      (* ??c ??d))))\\n           (and (non-negative-factors! xs ys 'c5)\\n                (r/template\\n                 m (/ (* ??a (sqrt (/ ~xs ~ys)) ??b)\\n                      (* ??c ??d)))))))))))\", :nextjournal/opts {:id \"emmy.simplify.rules/sqrt-contract-code\", :loc {:line 631, :end-line 697, :column 1, :end-column 44}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$sqrt_contract 0x3210d115 \\\"emmy.simplify.rules$sqrt_contract@3210d115\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/sqrt-contract-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/sqrt-contract-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"emmy.simplify.rules/markdown-5drRtZMYeUeVP5b6amCxg5EpqLsWKe\"} [\"h2\" {:id \"log-/-exp\"} [:<> \"Log / Exp\"]]], :nextjournal/opts {:id \"emmy.simplify.rules/markdown-5drRtZMYeUeVP5b6amCxg5EpqLsWKe\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-with-react-key, :hash \"5drtFhRgc8WMLrXw6DB4bZLsNZjHHp\"}} {:path [], :nextjournal/value \"(def specfun->logexp\\n  (let [two-i (c/complex 0.0 2.0)]\\n    (rule-simplifier\\n     (ruleset\\n      (sqrt ?x) => (exp (* (/ 1 2) (log ?x)))\\n\\n      (atan ?z)\\n      => (/ (- (log (+ 1 (* ~c/I ?z)))\\n               (log (- 1 (* ~c/I ?z))))\\n            ~two-i)\\n\\n      (asin ?z)\\n      => (* ~(g/- c/I)\\n            (log (+ (* ~c/I ?z)\\n                    (sqrt (- 1 (expt ?z 2))))))\\n\\n      (acos ?z)\\n      => (* ~(g/- c/I)\\n            (log\\n             (+ ?z (* ~c/I (sqrt (- 1 (expt ?z 2)))))))\\n\\n      (sinh ?u) => (/ (- (exp ?u) (exp (* -1 ?u))) 2)\\n\\n      (cosh ?u) => (/ (+ (exp ?u) (exp (* -1 ?u))) 2)\\n\\n      (expt ?x (? ?y not-integral?)) => (exp (* ?y (log ?x)))))))\", :nextjournal/opts {:id \"emmy.simplify.rules/specfun->logexp-code\", :loc {:line 701, :end-line 726, :column 1, :end-column 66}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0x3aacc385 \\\"clojure.lang.AFunction$1@3aacc385\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/specfun->logexp-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/specfun->logexp-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def logexp->specfun\\n  (rule-simplifier\\n   (ruleset\\n    (exp (* -1 (log ?x))) => (expt ?x -1)\\n\\n    (exp (* (/ 1 2) (log ?x))) => (sqrt ?x)\\n\\n    (exp (* (/ -1 2) (log ?x))) => (/ 1 (sqrt ?x))\\n\\n    (exp (* (/ 3 2) (log ?x))) => (expt (sqrt ?x) 3)\\n\\n    (exp (* (/ -3 2) (log ?x))) => (expt (sqrt ?x) -3)\\n\\n    (exp (* ??n1 (log ?x) ??n2))\\n    => (expt ?x (* ??n1 ??n2)))))\", :nextjournal/opts {:id \"emmy.simplify.rules/logexp->specfun-code\", :loc {:line 728, :end-line 742, :column 1, :end-column 34}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0x6487785 \\\"clojure.lang.AFunction$1@6487785\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/logexp->specfun-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/logexp->specfun-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn log-contract [simplify]\\n  (rule-simplifier\\n   (ruleset\\n    (+ ??x1 (log ?x2) ??x3 (log ?x4) ??x5)\\n    => (+ ??x1 ??x3 ??x5 (log (* ?x2 ?x4)))\\n\\n    (- (log ?x) (log ?y))\\n    => (log (/ ?x ?y))\\n\\n    (+ ??x1\\n       (* ??f1 (log ?x) ??f2)\\n       ??x2\\n       (* ??f3 (log ?y) ??f4)\\n       ??x3)\\n    (fn [m]\\n      (let [s1 (simplify (r/template m (* ??f1 ??f2)))\\n            s2 (simplify (r/template m (* ??f3 ??f4)))]\\n        (when (v/exact-zero?\\n               (simplify (list '- s1 s2)))\\n          {'??s1 s1})))\\n    (+ (* (log (* ?x ?y)) ??s1)\\n       ??x1 ??x2 ??x3))))\", :nextjournal/opts {:id \"emmy.simplify.rules/log-contract-code\", :loc {:line 744, :end-line 765, :column 1, :end-column 26}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$log_contract 0x23b4d359 \\\"emmy.simplify.rules$log_contract@23b4d359\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/log-contract-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/log-contract-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def log-expand\\n  (rule-simplifier\\n   (ruleset\\n    (log (* ?x1 ?x2 ??xs))\\n    => (+ (log ?x1) (log (* ?x2 ??xs)))\\n\\n    (log (/ ?x1 ?x2))\\n    => (- (log ?x1) (log ?x2))\\n\\n    (log (expt ?x ?e))\\n    => (* ?e (log ?x)))))\", :nextjournal/opts {:id \"emmy.simplify.rules/log-expand-code\", :loc {:line 767, :end-line 777, :column 1, :end-column 26}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0x17983643 \\\"clojure.lang.AFunction$1@17983643\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/log-expand-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/log-expand-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def log-extra\\n  (rule-simplifier\\n   (ruleset\\n    (* (? ?n v/integral?) ??f1 (log ?x) ??f2)\\n    => (* ??f1 (log (expt ?x ?n)) ??f2))))\", :nextjournal/opts {:id \"emmy.simplify.rules/log-extra-code\", :loc {:line 779, :end-line 783, :column 1, :end-column 43}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0x4b747fde \\\"clojure.lang.AFunction$1@4b747fde\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/log-extra-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/log-extra-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"emmy.simplify.rules/markdown-5dt2jBvhg7x9Fqn7tgppEVnHHHXdsx\"} [\"h2\" {:id \"partials\"} [:<> \"Partials\"]]], :nextjournal/opts {:id \"emmy.simplify.rules/markdown-5dt2jBvhg7x9Fqn7tgppEVnHHHXdsx\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-with-react-key, :hash \"5drtFhRgc8WMLrXw6DB4bZLsNZjHHp\"}} {:path [], :nextjournal/value \"(def canonicalize-partials\\n  (rule-simplifier\\n   (ruleset\\n    ;; Convert nests into products.\\n    ((partial ??i) ((partial ??j) ?f))\\n    => ((* (partial ??i) (partial ??j)) ?f)\\n\\n    ((partial ??i) ((* (partial ??j) ??more) ?f))\\n    => ((* (partial ??i) (partial ??j) ??more) ?f)\\n\\n    ;; Gather exponentiated partials into products\\n    ((expt (partial ??i) ?n) ((partial ??j) ?f))\\n    => ((* (expt (partial ??i) ?n) (partial ??j)) ?f)\\n\\n    ((partial ??i) ((expt (partial ??j) ?n) ?f))\\n    => ((* (partial ??i) (expt (partial ??j) ?n)) ?f)\\n\\n    ((expt (partial ??i) ?n) ((expt (partial ??j) ?m) ?f))\\n    => ((* (expt (partial ??i) ?n) (expt (partial ??j) ?m)) ?f)\\n\\n    ;; Same idea, trickier when some accumulation has already occurred.\\n    ((expt (partial ??i) ?n) ((* (partial ??j) ??more) ?f))\\n    => ((* (expt (partial ??i) ?n) (partial ??j) ??more) ?f)\\n\\n    ((partial ??i) ((* (expt (partial ??j) ?m) ??more) ?f))\\n    => ((* (partial ??i) (expt (partial ??j) ?m) ??more) ?f)\\n\\n    ((expt (partial ??i) ?n) ((* (expt (partial ??j) ?m) ??more) ?f))\\n    => ((* (expt (partial ??i) ?n) (expt (partial ??j) ?m) ??more) ?f))\\n\\n   (r/guard\\n    (fn [_] *commute-partials?*)\\n    ;; See [[*commute-partials?*]] above for a description of this\\n    ;; transformation.\\n    ;;\\n    ;; TODO in the predicate, implement `symb:elementary-access?` and make sure\\n    ;; that this only sorts if we can prove that we go all the way to the botom.\\n    (r/rule\\n     (((* ??xs (partial ??i) ??ys (partial ??j) ??zs) ?f) ??args)\\n\\n     (fn [{i '??i j '??j}]\\n       (pos?\\n        (compare (vec i) (vec j))))\\n     (((* ??xs (partial ??j) ??ys (partial ??i) ??zs) ?f) ??args)))))\", :nextjournal/opts {:id \"emmy.simplify.rules/canonicalize-partials-code\", :loc {:line 787, :end-line 830, :column 1, :end-column 70}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0xec5cd6a \\\"clojure.lang.AFunction$1@ec5cd6a\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/canonicalize-partials-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/canonicalize-partials-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"emmy.simplify.rules/markdown-5dstLWxkcwwFWTcq2T6W2DrSs56jaH\"} [\"h2\" {:id \"trigonometric-rules\"} [:<> \"Trigonometric Rules\"]] [:p [:<> \"the following rules are used to convert all trig expressions to ones\"] [#viewer-eval nextjournal.clerk.render/inspect-presented {:nextjournal/value [:<> \" \"], :nextjournal/viewer {:name nextjournal.clerk.viewer/html-viewer, :render-fn #viewer-fn identity, :hash \"5du5eveS8XMqMDMYH5rpQ1bqryEJdg\"}}] [:<> \"involving only sin and cos functions, and to make 1-arg atan into 2-arg atan.\"]]], :nextjournal/opts {:id \"emmy.simplify.rules/markdown-5dstLWxkcwwFWTcq2T6W2DrSs56jaH\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-with-react-key, :hash \"5drtFhRgc8WMLrXw6DB4bZLsNZjHHp\"}} {:path [], :nextjournal/value \"(def trig->sincos\\n  (rule-simplifier\\n   (ruleset\\n    (tan ?x) => (/ (sin ?x) (cos ?x))\\n\\n    (cot ?x) => (/ (cos ?x) (sin ?x))\\n\\n    (sec ?x) => (/ 1 (cos ?x))\\n\\n    (csc ?x) => (/ 1 (sin ?x))\\n\\n    (atan (/ ?y ?x)) => (atan ?y ?x)\\n\\n    (atan ?y) => (atan ?y 1))))\", :nextjournal/opts {:id \"emmy.simplify.rules/trig->sincos-code\", :loc {:line 837, :end-line 850, :column 1, :end-column 32}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0xb6ee9f0 \\\"clojure.lang.AFunction$1@b6ee9f0\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/trig->sincos-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/trig->sincos-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def sincos->trig\\n  (rule-simplifier\\n   (ruleset\\n    (/ (sin ?x) (cos ?x)) => (tan ?x)\\n\\n    (/ (* ??n1 (sin ?x) ??n2) (cos ?x))\\n    => (* ??n1 (tan ?x) ??n2)\\n\\n    (/ (sin ?x) (* ??d1 (cos ?x) ??d2))\\n    => (/ (tan ?x) (* ??d1 ??d2))\\n\\n    (/ (* ??n1 (sin ?x) ??n2)\\n       (* ??d1 (cos ?x) ??d2))\\n    => (/ (* ??n1 (tan ?x) ??n2)\\n          (* ??d1 ??d2)))))\", :nextjournal/opts {:id \"emmy.simplify.rules/sincos->trig-code\", :loc {:line 852, :end-line 866, :column 1, :end-column 28}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0x5d12ecf0 \\\"clojure.lang.AFunction$1@5d12ecf0\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/sincos->trig-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/sincos->trig-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn triginv [simplify]\\n  (r/rule-simplifier\\n   (let [sym:atan (sym/symbolic-operator 'atan)]\\n     (r/guard\\n      (fn [_] *aggressive-atan-simplify?*)\\n      (r/rule\\n       (atan ?y ?x)\\n       (fn [{x '?x y '?y}]\\n         (let [xs (simplify x)\\n               ys (simplify y)]\\n           (if (v/= ys xs)\\n             (if (v/number? ys)\\n               (if (g/negative? ys)\\n                 '(- (/ (* 3 pi) 4))\\n                 '(/ pi 4))\\n               (and (ul/assume!\\n                     (list 'positive? xs)\\n                     'aggressive-atan-1)\\n                    '(/ pi 4)))\\n             (if (and (v/number? ys)\\n                      (v/number? xs))\\n               (sym:atan ys xs)\\n               (let [s (simplify (list 'gcd ys xs))]\\n                 (when-not (v/one? s)\\n                   (and (ul/assume!\\n                         (list 'positive? s)\\n                         'aggressive-atan-2)\\n                        (let [yv (simplify (list '/ ys s))\\n                              xv (simplify (list '/ xs s))]\\n                          (r/template\\n                           (atan ~yv ~xv)))))))))))))\\n\\n   (ruleset\\n    (sin (asin ?x)) => ?x\\n    (cos (acos ?x)) => ?x\\n    (tan (atan ?x)) => ?x\\n    (sin (acos ?x)) => (sqrt (- 1 (expt ?x 2)))\\n    (cos (asin ?y)) => (sqrt (- 1 (expt ?y 2)))\\n    (tan (asin ?y)) => (/ ?y (sqrt (- 1 (expt ?y 2))))\\n    (tan (acos ?x)) => (/ (sqrt (- 1 (expt ?x 2))) ?x)\\n\\n    (sin (atan ?a ?b))\\n    => (/ ?a (sqrt (+ (expt ?a 2) (expt ?b 2))))\\n\\n    (cos (atan ?a ?b))\\n    => (/ ?b (sqrt (+ (expt ?a 2) (expt ?b 2)))))\\n\\n   (r/guard\\n    (fn [_] *inverse-simplify?*)\\n    (ruleset\\n     (asin (sin ?x))\\n     (fn [{x '?x}]\\n       (let [xs (simplify x)]\\n         (ul/assume!\\n          (r/template\\n           (= (asin (sin ~xs)) ~xs))\\n          'asin-sin)))\\n     ?x\\n\\n     (acos (cos ?x))\\n     (fn [{x '?x}]\\n       (let [xs (simplify x)]\\n         (ul/assume!\\n          (r/template\\n           (= (acos (cos ~xs)) ~xs))\\n          'acos-cos)))\\n     ?x\\n\\n     (atan (tan ?x))\\n     (fn [{x '?x}]\\n       (let [xs (simplify x)]\\n         (ul/assume!\\n          (r/template\\n           (= (atan (tan ~xs)) ~xs))\\n          'atan-tan)))\\n     ?x\\n\\n     (atan (sin ?x) (cos ?x))\\n     (fn [{x '?x}]\\n       (let [xs (simplify x)]\\n         (ul/assume!\\n          (r/template\\n           (= (atan (sin ~xs) (cos ~xs)) ~xs))\\n          'atan-sin-cos)))\\n     ?x\\n\\n     (asin (cos ?x))\\n     (fn [{x '?x}]\\n       (let [xs (simplify x)]\\n         (ul/assume!\\n          (r/template\\n           (= (asin (cos ~xs))\\n              (- (* (/ 1 2) pi) ~xs)))\\n          'asin-cos)))\\n     (- (* (/ 1 2) pi) ?x)\\n\\n     (acos (sin ?x))\\n     (fn [{x '?x}]\\n       (let [xs (simplify x)]\\n         (ul/assume!\\n          (r/template\\n           (= (acos (sin ~xs))\\n              (- (* (/ 1 2) pi) ~xs)))\\n          'acos-sin)))\\n     (- (* (/ 1 2) pi) ?x)))))\", :nextjournal/opts {:id \"emmy.simplify.rules/triginv-code\", :loc {:line 868, :end-line 972, :column 1, :end-column 31}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$triginv 0x35f0e203 \\\"emmy.simplify.rules$triginv@35f0e203\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/triginv-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/triginv-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn trig:special\\n  \\\"TODO consolidate the symbolic checkers here with the constructor\\n  simplifications in [[trig:special]]. \\\"\\n  [simplify]\\n  (let [sym:+   (sym/symbolic-operator '+)\\n        sym:-   (sym/symbolic-operator '-)\\n        sym:*   (sym/symbolic-operator '*)\\n        sym:div (sym/symbolic-operator '/)]\\n    (letfn [(zero-mod-pi? [x]\\n              (or (sym/zero-mod-pi? x)\\n                  (v/integral?\\n                   (simplify (sym:div x 'pi)))))\\n\\n            (pi-over-2-mod-2pi? [x]\\n              (or (sym/pi-over-2-mod-2pi? x)\\n                  (v/integral?\\n                   (simplify\\n                    (sym:div (sym:- x (sym:div 'pi 2))\\n                             (sym:* 2 'pi))))))\\n\\n            (-pi-over-2-mod-2pi? [x]\\n              (or (sym/-pi-over-2-mod-2pi? x)\\n                  (v/integral?\\n                   (simplify\\n                    (sym:div (sym:+ x (sym:div 'pi 2))\\n                             (sym:* 2 'pi))))))\\n\\n            (pi-over-2-mod-pi? [x]\\n              (or (sym/pi-over-2-mod-pi? x)\\n                  (v/integral?\\n                   (simplify\\n                    (sym:div (sym:- x (sym:div 'pi 2))\\n                             'pi)))))\\n\\n            (zero-mod-2pi? [x]\\n              (or (sym/zero-mod-2pi? x)\\n                  (v/integral?\\n                   (simplify\\n                    (sym:div x (sym:* 2 'pi))))))\\n\\n            (pi-mod-2pi? [x]\\n              (or (sym/pi-mod-2pi? x)\\n                  (v/integral?\\n                   (simplify\\n                    (sym:div (sym:- x 'pi)\\n                             (sym:* 2 'pi))))))\\n\\n            (pi-over-4-mod-pi? [x]\\n              (or (sym/pi-over-4-mod-pi? x)\\n                  (v/integral?\\n                   (simplify\\n                    (sym:div (sym:- x (sym:div 'pi 4)) 'pi)))))\\n\\n            (-pi-over-4-mod-pi? [x]\\n              (or (sym/-pi-over-4-mod-pi? x)\\n                  (v/integral?\\n                   (simplify\\n                    (sym:div (sym:+ x (sym:div 'pi 4))\\n                             'pi)))))]\\n      (rule-simplifier\\n       (ruleset\\n        (sin (? _ zero-mod-pi?)) => 0\\n        (sin (? _ pi-over-2-mod-2pi?)) => +1\\n        (sin (? _ -pi-over-2-mod-2pi?)) => -1\\n\\n        (cos (? _ pi-over-2-mod-pi?)) => 0\\n        (cos (? _ zero-mod-2pi?)) => +1\\n        (cos (? _ pi-mod-2pi?)) => -1\\n\\n        (tan (? _ zero-mod-pi?)) => 0\\n        (tan (? _ pi-over-4-mod-pi?)) => +1\\n        (tan (? _ -pi-over-4-mod-pi?)) => -1)))))\", :nextjournal/opts {:id \"emmy.simplify.rules/trig:special-code\", :loc {:line 974, :end-line 1045, :column 1, :end-column 50}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$trig_COLON_special 0x15fed74a \\\"emmy.simplify.rules$trig_COLON_special@15fed74a\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/trig:special-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/trig:special-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def angular-parity\\n  \\\"`sin` is odd, and `cos` is even. we canonicalize by moving the sign out of the\\n  first term of the argument.\\\"\\n  (rule-simplifier\\n   (ruleset\\n    (cos (? ?n negative-number?))\\n    => (cos (? #(- (% '?n))))\\n\\n    (cos (* (? ?n negative-number?) ??x))\\n    => (cos (* (? #(- (% '?n))) ??x))\\n\\n    (cos (+ (* (? ?n negative-number?) ??x) ??y))\\n    => (cos (- (* (? #(- (% '?n))) ??x) ??y))\\n\\n    (sin (? ?n negative-number?))\\n    => (- (sin (? #(- (% '?n)))))\\n\\n    (sin (* (? ?n negative-number?) ??x))\\n    => (- (sin (* (? #(- (% '?n))) ??x)))\\n\\n    (sin (+ (* (? ?n negative-number?) ??x) ??y))\\n    => (- (sin (- (* (? #(- (% '?n))) ??x) ??y))))))\", :nextjournal/opts {:id \"emmy.simplify.rules/angular-parity-code\", :loc {:line 1047, :end-line 1068, :column 1, :end-column 53}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0x69a38d6c \\\"clojure.lang.AFunction$1@69a38d6c\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/angular-parity-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/angular-parity-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def expand-multiangle\\n  (letfn [(exact-integer>3? [x]\\n            (and (v/integral? x)\\n                 (v/exact? x)\\n                 (> x 3)))]\\n    (rule-simplifier\\n     (ruleset\\n      (sin (* 2 ?x ??y))\\n      => (* 2 (sin (* ?x ??y)) (cos (* ?x ??y)))\\n\\n      (cos (* 2 ?x ??y))\\n      => (- (* 2 (expt (cos (* ?x ??y)) 2)) 1)\\n\\n      (sin (* 3 ?x ??y))\\n      => (+ (* 3 (sin (* ?x ??y))) (* -4 (expt (sin (* ?x ??y)) 3)))\\n\\n      (cos (* 3 ?x ??y))\\n      => (+ (* 4 (expt (cos (* ?x ??y)) 3)) (* -3 (cos (* ?x ??y))))\\n\\n      ;; at least one f:\\n      (sin (* (? n exact-integer>3?) ?f ??fs))\\n      => (+ (* (sin (* (? #(g/- (% 'n) 1)) ?f ??fs))\\n               (cos (* ?f ??fs)))\\n            (* (cos (* (? #(g/- (% 'n) 1)) ?f ??fs))\\n               (sin (* ?f ??fs))))\\n\\n      ;; at least one y:\\n      (sin (+ ?x ?y ??ys))\\n      => (+ (* (sin ?x) (cos (+ ?y ??ys)))\\n            (* (cos ?x) (sin (+ ?y ??ys))))\\n\\n      ;; at least one f:\\n      (cos (* (? n exact-integer>3?) ?f ??fs))\\n      => (- (* (cos (* (? #(g/- (% 'n) 1)) ?f ??fs))\\n               (cos (* ?f ??fs)))\\n            (* (sin (* (? #(g/- (% 'n) 1)) ?f ??fs))\\n               (sin (* ?f ??fs))))\\n\\n      ;; at least one y:\\n      (cos (+ ?x ?y ??ys))\\n      => (- (* (cos ?x) (cos (+ ?y ??ys)))\\n            (* (sin ?x) (sin (+ ?y ??ys))))))))\", :nextjournal/opts {:id \"emmy.simplify.rules/expand-multiangle-code\", :loc {:line 1070, :end-line 1111, :column 1, :end-column 48}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0x231c89c4 \\\"clojure.lang.AFunction$1@231c89c4\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/expand-multiangle-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/expand-multiangle-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def trig:sum->product\\n  (rule-simplifier\\n   (ruleset\\n    (+ ??a (sin ?x) ??b (sin ?y) ??c)\\n    => (+ (* 2 (sin (/ (+ ?x ?y) 2)) (cos (/ (- ?x ?y) 2)))\\n          ??a ??b ??c)\\n\\n    (+ ??a (sin ?x) ??b (* -1 (sin ?y)) ??c)\\n    => (+ (* 2 (sin (/ (- ?x ?y) 2)) (cos (/ (+ ?x ?y) 2)))\\n          ??a ??b ??c)\\n\\n    (+ ??a (* -1 (sin ?y)) ??b (sin ?x) ??c)\\n    => (+ (* 2 (sin (/ (- ?x ?y) 2)) (cos (/ (+ ?x ?y) 2)))\\n          ??a ??b ??c)\\n\\n    (+ ??a (cos ?x) ??b (cos ?y) ??c)\\n    => (+ (* 2 (cos (/ (+ ?x ?y) 2)) (cos (/ (- ?x ?y) 2)))\\n          ??a ??b ??c)\\n\\n    (+ ??a (cos ?x) ??b (* -1 (cos ?y)) ??c)\\n    => (+ (* -2 (sin (/ (+ ?x ?y) 2)) (sin (/ (- ?x ?y) 2)))\\n          ??a ??b ??c)\\n\\n    (+ ??a (* -1 (cos ?y)) ??b (cos ?x) ??c)\\n    => (+ (* -2 (sin (/ (+ ?x ?y) 2)) (sin (/ (- ?x ?y) 2)))\\n          ??a ??b ??c))))\", :nextjournal/opts {:id \"emmy.simplify.rules/trig:sum->product-code\", :loc {:line 1113, :end-line 1138, :column 1, :end-column 26}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0x114e975e \\\"clojure.lang.AFunction$1@114e975e\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/trig:sum->product-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/trig:sum->product-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def trig:product->sum\\n  (rule-simplifier\\n   (ruleset\\n    (* ??u (sin ?x) ??v (sin ?y) ??w)\\n    => (* (/ 1 2) (- (cos (- ?x ?y)) (cos (+ ?x ?y)))\\n          ??u ??v ??w)\\n\\n    (* ??u (cos ?x) ??v (cos ?y) ??w)\\n    => (* (/ 1 2) (+ (cos (- ?x ?y)) (cos (+ ?x ?y)))\\n          ??u ??v ??w)\\n\\n    (* ??u (sin ?x) ??v (cos ?y) ??w)\\n    => (* (/ 1 2) (+ (sin (+ ?x ?y)) (sin (- ?x ?y)))\\n          ??u ??v ??w)\\n\\n    (* ??u (cos ?y) ??v (sin ?x) ??w)\\n    => (* (/ 1 2) (+ (sin (+ ?x ?y)) (sin (- ?x ?y)))\\n          ??u ??v ??w))))\", :nextjournal/opts {:id \"emmy.simplify.rules/trig:product->sum-code\", :loc {:line 1140, :end-line 1157, :column 1, :end-column 26}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0x726946ba \\\"clojure.lang.AFunction$1@726946ba\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/trig:product->sum-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/trig:product->sum-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def contract-expt-trig\\n  (letfn [(exact-integer>1? [x]\\n            (and (v/integral? x)\\n                 (v/exact? x)\\n                 (> x 1)))]\\n    (rule-simplifier\\n     (ruleset\\n      (expt (sin ?x) (? ?n exact-integer>1?))\\n      => (* (/ 1 2)\\n            (expt (sin ?x) (? #(- (% '?n) 2)))\\n            (- 1 (cos (* 2 ?x))))\\n\\n      (expt (cos ?x) (? ?n exact-integer>1?))\\n      => (* (/ 1 2)\\n            (expt (cos ?x) (? #(- (% '?n) 2)))\\n            (+ 1 (cos (* 2 ?x))))))))\", :nextjournal/opts {:id \"emmy.simplify.rules/contract-expt-trig-code\", :loc {:line 1159, :end-line 1174, :column 1, :end-column 38}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0x7547d76 \\\"clojure.lang.AFunction$1@7547d76\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/contract-expt-trig-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/contract-expt-trig-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn half-angle [simplify]\\n  (letfn [(sin-half-angle-formula [theta]\\n            (let [thetas (simplify theta)]\\n              (and (ul/assume!\\n                    (r/template\\n                     (non-negative?\\n                      (+ (* 2 pi)\\n                         (* -1 ~thetas)\\n                         (* 4 pi (floor (/ ~thetas (* 4 pi)))))))\\n                    'sin-half-angle-formula)\\n                   (r/template\\n                    (sqrt (/ (- 1 (cos ~theta)) 2))))))\\n\\n          (cos-half-angle-formula [theta]\\n            (let [thetas (simplify theta)]\\n              (and (ul/assume!\\n                    (r/template\\n                     (non-negative?\\n                      (+ pi ~thetas\\n                         (* 4 pi (floor\\n                                  (/ (- pi ~thetas)\\n                                     (* 4 pi)))))))\\n                    'cos-half-angle-formula)\\n                   (r/template\\n                    (sqrt (/ (+ 1 (cos ~theta)) 2))))))]\\n    (r/attempt\\n     (r/guard\\n      (fn [_] *half-angle-simplify?*)\\n      (rule-simplifier\\n       (r/ruleset*\\n        (r/rule\\n         (sin (* (/ 1 2) ?x ??y))\\n         #(sin-half-angle-formula\\n           (r/template % (* ?x ??y))))\\n\\n        (r/rule\\n         (sin (/ ?x 2))\\n         #(sin-half-angle-formula (% '?x)))\\n\\n        (r/rule\\n         (cos (* (/ 1 2) ?x ??y))\\n         #(cos-half-angle-formula\\n           (r/template % (* ?x ??y))))\\n\\n        (r/rule\\n         (cos (/ ?x 2))\\n         #(cos-half-angle-formula (% '?x)))))))))\", :nextjournal/opts {:id \"emmy.simplify.rules/half-angle-code\", :loc {:line 1176, :end-line 1222, :column 1, :end-column 50}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$half_angle 0x40c186f1 \\\"emmy.simplify.rules$half_angle@40c186f1\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/half-angle-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/half-angle-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def sin-sq->cos-sq\\n  (rule-simplifier\\n   (ruleset\\n    (expt (sin ?x) (? ?n at-least-two?))\\n    => (* (expt (sin ?x) (? #(- (% '?n) 2)))\\n          (- 1 (expt (cos ?x) 2))))))\", :nextjournal/opts {:id \"emmy.simplify.rules/sin-sq->cos-sq-code\", :loc {:line 1224, :end-line 1229, :column 1, :end-column 38}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0x25d00dd0 \\\"clojure.lang.AFunction$1@25d00dd0\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/sin-sq->cos-sq-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/sin-sq->cos-sq-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def cos-sq->sin-sq\\n  (rule-simplifier\\n   (ruleset\\n    (expt (cos ?x) (? ?n at-least-two?))\\n    => (* (expt (cos ?x) (? #(- (% '?n) 2)))\\n          (- 1 (expt (sin ?x) 2))))))\", :nextjournal/opts {:id \"emmy.simplify.rules/cos-sq->sin-sq-code\", :loc {:line 1231, :end-line 1236, :column 1, :end-column 38}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0x1d34c346 \\\"clojure.lang.AFunction$1@1d34c346\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/cos-sq->sin-sq-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/cos-sq->sin-sq-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def split-high-degree-sincos\\n  (letfn [(remaining [{n '?n :as m}]\\n            (let [n-2 (g/- n 2)]\\n              (if (v/one? n-2)\\n                (r/template m (?op ?x))\\n                (r/template\\n                 m (expt (?op ?x) ~n-2)))))]\\n    (rule-simplifier\\n     (ruleset\\n      (* ??f1\\n         (expt ((? ?op #{'sin 'cos}) ?x) (? ?n more-than-two?))\\n         ??f2)\\n      => (* ??f1\\n            (expt (?op ?x) 2) (? ~remaining)\\n            ??f2)\\n\\n      (+ ??a1\\n         (expt ((? ?op #{'sin 'cos}) ?x) (? ?n more-than-two?))\\n         ??a2)\\n      => (+ ??a1\\n            (* (expt (?op ?x) 2) (? ~remaining))\\n            ??a2)))))\", :nextjournal/opts {:id \"emmy.simplify.rules/split-high-degree-sincos-code\", :loc {:line 1238, :end-line 1259, :column 1, :end-column 22}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0x392fa25b \\\"clojure.lang.AFunction$1@392fa25b\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/split-high-degree-sincos-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/split-high-degree-sincos-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn flush-obvious-ones [simplify]\\n  (let [?op      (pm/bind '?op #{'sin 'cos})\\n        ?flipped (pm/or (pm/and 'cos (pm/frame-predicate\\n                                      #(= 'sin (% '?op))))\\n                        (pm/and 'sin (pm/frame-predicate\\n                                      #(= 'cos (% '?op)))))]\\n    (letfn [(pred [m]\\n              (let [s1 (simplify (r/template m (* ??f1 ??f2)))\\n                    s2 (simplify (r/template m (* ??f3 ??f4)))]\\n                (when (v/exact-zero?\\n                       (simplify (list '- s1 s2)))\\n                  {'?s1 s1})))]\\n      (rule-simplifier\\n       (ruleset\\n        (+ ??a1 (expt (~?op ?x) 2)\\n           ??a2 (expt (~?flipped ?x) 2)\\n           ??a3)\\n        => (+ 1 ??a1 ??a2 ??a3)\\n\\n        (+ ??a1 (* ??f1 (expt (~?op ?x) 2) ??f2)\\n           ??a2 (* ??f3 (expt (~?flipped ?x) 2) ??f4)\\n           ??a3)\\n        pred\\n        (+ ??a1 ??a2 ??a3 ?s1))))))\", :nextjournal/opts {:id \"emmy.simplify.rules/flush-obvious-ones-code\", :loc {:line 1261, :end-line 1284, :column 1, :end-column 36}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$flush_obvious_ones 0x75155d81 \\\"emmy.simplify.rules$flush_obvious_ones@75155d81\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/flush-obvious-ones-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/flush-obvious-ones-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn sincos-flush-ones [simplify]\\n  (r/pipe\\n   split-high-degree-sincos\\n   (flush-obvious-ones simplify)))\", :nextjournal/opts {:id \"emmy.simplify.rules/sincos-flush-ones-code\", :loc {:line 1286, :end-line 1289, :column 1, :end-column 35}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$sincos_flush_ones 0x500e707e \\\"emmy.simplify.rules$sincos_flush_ones@500e707e\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/sincos-flush-ones-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/sincos-flush-ones-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn sincos-random [simplify]\\n  (let [simplifies-to-zero? (comp v/zero? simplify)\\n        ops #{'cos 'sin}\\n        flip {'cos 'sin, 'sin 'cos}]\\n    (rule-simplifier\\n     (letfn [(pred [{n '?n op '?op :as m}]\\n               (when (simplifies-to-zero?\\n                      (r/template m (+ ?a (expt (?op ?x) ~(g/- n 2)))))\\n                 {'?other-op (flip op)}))]\\n       (ruleset\\n        ;;  ... + a + ... + cos^n x + ...   if a + cos^(n-2) x = 0: a sin^2 x\\n        (+ ??a1 ?a ??a2 (expt ((? ?op ops) ?x) (? ?n at-least-two?)) ??a3)\\n        pred\\n        (+ ??a1 ??a2 ??a3 (* ?a (expt (?other-op ?x) 2)))\\n\\n        (+ ??a1 (expt ((? ?op ops) ?x) (? ?n at-least-two?)) ??a2 ?a ??a3)\\n        pred\\n        (+ ??a1 ??a2 ??a3 (* ?a (expt (?other-op ?x) 2)))))\\n\\n     (letfn [(pred [{n '?n op '?op :as m}]\\n               (when (simplifies-to-zero?\\n                      (r/template m (+ ?a (* ??b1 ??b2 (expt (?op ?x) ~(g/- n 2))))))\\n                 {'?other-op (flip op)}))]\\n       (ruleset\\n        (+ ??a1 ?a ??a2 (* ??b1 (expt ((? ?op ops) ?x) (? ?n at-least-two?)) ??b2)\\n           ??a3)\\n        pred\\n        (+ ??a1 ??a2 ??a3 (* ?a (expt (?other-op ?x) 2)))\\n\\n        (+ ??a1 (* ??b1 (expt ((? ?op ops) ?x) (? ?n at-least-two?)) ??b2) ??a2 ?a\\n           ??a3)\\n        pred\\n        (+ ??a1 ??a2 ??a3 (* ?a (expt (?other-op ?x) 2))))))))\", :nextjournal/opts {:id \"emmy.simplify.rules/sincos-random-code\", :loc {:line 1291, :end-line 1323, :column 1, :end-column 63}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$sincos_random 0x6b1ba7ca \\\"emmy.simplify.rules$sincos_random@6b1ba7ca\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/sincos-random-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/sincos-random-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"emmy.simplify.rules/markdown-5dsPsxbnkhRXD7YDPC3T12C7LKRfNY\"} [:p [:<> \"we can eliminate sin and cos in favor of complex exponentials.\"]]], :nextjournal/opts {:id \"emmy.simplify.rules/markdown-5dsPsxbnkhRXD7YDPC3T12C7LKRfNY\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-with-react-key, :hash \"5drtFhRgc8WMLrXw6DB4bZLsNZjHHp\"}} {:path [], :nextjournal/value \"(def sincos->exp1\\n  (let [-I (g/- c/I)]\\n    (rule-simplifier\\n     (ruleset\\n      (sin ?x)\\n      => (/ (- (exp (* ~c/I ?x)) (exp (* ~-I ?x)))\\n            ~(c/complex 0.0 2.0))\\n\\n      (cos ?x)\\n      => (/ (+ (exp (* ~c/I ?x)) (exp (* ~-I ?x)))\\n            2)))))\", :nextjournal/opts {:id \"emmy.simplify.rules/sincos->exp1-code\", :loc {:line 1327, :end-line 1337, :column 1, :end-column 19}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0x2f62ed88 \\\"clojure.lang.AFunction$1@2f62ed88\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/sincos->exp1-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/sincos->exp1-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def sincos->exp2\\n  (rule-simplifier\\n   (ruleset\\n    (sin ?x)\\n    => (/ (- (exp (* ~c/I ?x)) (/ 1 (exp (* ~c/I ?x))))\\n          ~(g/* 2 c/I))\\n\\n    (cos ?x)\\n    => (/ (+ (exp (* ~c/I ?x)) (/ 1 (exp (* ~c/I ?x))))\\n          2))))\", :nextjournal/opts {:id \"emmy.simplify.rules/sincos->exp2-code\", :loc {:line 1339, :end-line 1348, :column 1, :end-column 16}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0x70c444b0 \\\"clojure.lang.AFunction$1@70c444b0\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/sincos->exp2-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/sincos->exp2-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value [:div.viewer.markdown-viewer.w-full.max-w-prose.px-8 {:data-block-id \"emmy.simplify.rules/markdown-5dtPREuuuxoQgjnHoYSf6akcXL4qh1\"} [:p [:<> \"under favorable conditions, we can replace the trig functions.\"]]], :nextjournal/opts {:id \"emmy.simplify.rules/markdown-5dtPREuuuxoQgjnHoYSf6akcXL4qh1\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/markdown-node-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-with-react-key, :hash \"5drtFhRgc8WMLrXw6DB4bZLsNZjHHp\"}} {:path [], :nextjournal/value \"(def exp->sincos\\n  (letfn [(positive? [x]\\n            (not (or (g/negative? x)\\n                     (v/zero? x))))\\n\\n          (pos-pred [m]\\n            (let [im (g/imag-part (m '?c1))]\\n              (when (positive? im)\\n                {'?im im})))\\n\\n          (neg-pred [m]\\n            (let [im (g/imag-part (m '?c1))]\\n              (when (g/negative? im)\\n                {'?im im})))]\\n    (rule-simplifier\\n     (ruleset\\n      (exp (? ?c1 imaginary-number?))\\n      pos-pred\\n      (+ (cos ?im)\\n         (* ~c/I (sin ?im)))\\n\\n      (exp (? ?c1 imaginary-number?))\\n      neg-pred\\n      (+ (cos (? #(- (% '?im))))\\n         (* ~(g/- c/I) (sin (? #(- (% '?im))))))\\n\\n      (exp (* (? ?c1 imaginary-number?) ??f))\\n      pos-pred\\n      (+ (cos (* ?im ??f))\\n         (* ~c/I (sin (* ?im ??f))))\\n\\n      (exp (* (? ?c1 imaginary-number?) ??f))\\n      neg-pred\\n      (* (exp (? #(g/real-part (% '?c1))))\\n         (+ (cos (* (? #(- (% '?im))) ??f))\\n            (* ~(g/- c/I) (sin (* (? #(- (% '?im))) ??f)))))\\n\\n      (exp (? ?c1 complex-number?))\\n      pos-pred\\n      (* (exp (? #(g/real-part (% '?c1))))\\n         (+ (cos ?im)\\n            (* ~c/I (sin ?im))))\\n\\n      (exp (? ?c1 complex-number?))\\n      neg-pred\\n      (* (exp (? #(g/real-part (% '?c1))))\\n         (+ (cos (? #(- (% '?im))))\\n            (* ~(g/- c/I) (sin (? #(- (% '?im)))))))\\n\\n      (exp (* (? ?c1 complex-number?) ??f))\\n      pos-pred\\n      (* (exp (? #(g/real-part (% '?c1))))\\n         (+ (cos (* ?im ??f))\\n            (* ~c/I (sin (* ?im ??f)))))\\n\\n      (exp (* (? ?c1 complex-number?) ??f))\\n      neg-pred\\n      (* (exp (? #(g/real-part (% '?c1))))\\n         (+ (cos (* (? #(- (% '?im))) ??f))\\n            (* ~(g/- c/I) (sin (* (? #(- (% '?im))) ??f)))))))))\", :nextjournal/opts {:id \"emmy.simplify.rules/exp->sincos-code\", :loc {:line 1352, :end-line 1411, :column 1, :end-column 65}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0x536a4756 \\\"clojure.lang.AFunction$1@536a4756\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/exp->sincos-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/exp->sincos-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def exp-contract\\n  (rule-simplifier\\n   (ruleset\\n    (* ??x1 (exp ?x2) ??x3 (exp ?x4) ??x5)\\n    =>\\n    (* ??x1 ??x3 ??x5 (exp (+ ?x2 ?x4)))\\n\\n    (expt (exp ?x) ?p) => (exp (* ?p ?x))\\n\\n    (/ (exp ?x) (exp ?y)) => (exp (- ?x ?y))\\n\\n    (/ (* ??x1 (exp ?x) ??x2) (exp ?y))\\n    =>\\n    (* ??x1 ??x2 (exp (- ?x ?y)))\\n\\n    (/ (exp ?x) (* ??y1 (exp ?y) ??y2))\\n    =>\\n    (/ (exp (- ?x ?y)) (* ??y1 ??y2))\\n\\n    (/ (* ??x1 (exp ?x) ??x2)\\n       (* ??y1 (exp ?y) ??y2))\\n    =>\\n    (/ (* ??x1 ??x2 (exp (- ?x ?y)))\\n       (* ??y1 ??y2)))))\", :nextjournal/opts {:id \"emmy.simplify.rules/exp-contract-code\", :loc {:line 1413, :end-line 1436, :column 1, :end-column 25}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0x65f99f06 \\\"clojure.lang.AFunction$1@65f99f06\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/exp-contract-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/exp-contract-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def exp-expand\\n  (let [exact-integer? (fn [x]\\n                         (and (v/integral? x)\\n                              (v/exact? x)))]\\n    (rule-simplifier\\n     (ruleset\\n      (exp (- ?x1)) => (/ 1 (exp ?x1))\\n\\n      (exp (- ?x1 ?x2)) => (/ (exp ?x1) (exp ?x2))\\n\\n      (exp (+ ?x1 ?x2 ??xs))\\n      =>\\n      (* (exp ?x1) (exp (+ ?x2 ??xs)))\\n\\n      (exp (* (? ?x imaginary-integer? #(> (g/imag-part %) 1))\\n              ??factors))\\n      =>\\n      (expt (exp (* ~c/I ??factors))\\n            (? #(g/imag-part (% '?x))))\\n\\n      (exp (* (? ?x imaginary-integer? #(< (g/imag-part %) -1))\\n              ??factors))\\n      =>\\n      (expt (exp (* ~(g/- c/I) ??factors))\\n            (? #(g/- (g/imag-part (% '?x)))))\\n\\n      (exp (* (? ?n exact-integer? #(> % 1))\\n              ??factors))\\n      =>\\n      (expt (exp (* ??factors)) ?n)\\n\\n      (exp (* (? ?n exact-integer? #(< % -1))\\n              ??factors))\\n      =>\\n      (expt (exp (* -1 ??factors))\\n            (? #(- (% '?n))))\\n\\n      (exp (? ?x complex-number?))\\n      =>\\n      (* (exp (? #(g/real-part (% '?x))))\\n         (exp (? #(g/* (g/imag-part (% '?x)) ~c/I))))\\n\\n      (exp (* (? ?x complex-number?)\\n              ??factors))\\n      =>\\n      (* (exp (* (? #(g/real-part (% '?x)))\\n                 ??factors))\\n         (exp (* (? #(g/* (g/imag-part (% '?x)) ~c/I))\\n                 ??factors)))))))\", :nextjournal/opts {:id \"emmy.simplify.rules/exp-expand-code\", :loc {:line 1438, :end-line 1486, :column 1, :end-column 34}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0x5dcf209c \\\"clojure.lang.AFunction$1@5dcf209c\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/exp-expand-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/exp-expand-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def complex-trig\\n  (rule-simplifier\\n   (ruleset\\n    (cos ~c/I) => (cosh 1)\\n    (cos (* ?z ~c/I)) => (cosh ?z)\\n    (cos (* ~c/I ?z)) => (cosh ?z)\\n    (cos (* ??xs ~c/I ??ys)) => (cosh (* ??xs ??ys))\\n\\n    (sin ~c/I) => (* ~c/I (sinh 1))\\n    (sin (* ?z ~c/I)) => (* ~c/I (sinh ?z))\\n    (sin (* ~c/I ?z)) => (* ~c/I (sinh ?z))\\n    (sin (* ??xs ~c/I ??ys)) => (* ~c/I (sinh (* ??xs ??ys))))))\", :nextjournal/opts {:id \"emmy.simplify.rules/complex-trig-code\", :loc {:line 1488, :end-line 1499, :column 1, :end-column 65}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0xf7c1e51 \\\"clojure.lang.AFunction$1@f7c1e51\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/complex-trig-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/complex-trig-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def complex-rules\\n  (let [ctor '(? ?op #{complex make-rectangular})]\\n    (rule-simplifier\\n     (ruleset\\n      (~ctor (cos ?theta) (sin ?theta))\\n      => (exp (* ~c/I ?theta))\\n\\n      (real-part (~ctor ?re _)) => ?re\\n      (imag-part (~ctor _ ?im)) => ?im\\n\\n      (magnitude (~ctor ?re ?im))\\n      => (sqrt (+ (expt ?re 2) (expt ?im 2)))\\n\\n      (angle (~ctor ?re ?im)) => (atan ?im ?re)\\n\\n      (real-part (make-polar ?m ?a)) => (* ?m (cos ?a))\\n      (imag-part (make-polar ?m ?a)) => (* ?m (sin ?a))\\n\\n      (magnitude (make-polar ?m _)) => ?m\\n      (angle (make-polar _ ?a)) => ?a))))\", :nextjournal/opts {:id \"emmy.simplify.rules/complex-rules-code\", :loc {:line 1501, :end-line 1520, :column 1, :end-column 42}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0xe2da81f \\\"clojure.lang.AFunction$1@e2da81f\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/complex-rules-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/complex-rules-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(def divide-numbers-through\\n  (rule-simplifier\\n   (ruleset\\n    (* 1 ?factor) => ?factor\\n    (* 1 ??factors) => (* ??factors)\\n\\n    (/ (? ?n v/number?)\\n       (? ?d v/number?))\\n    => (? (fn [{n '?n d '?d}]\\n            (g// n d)))\\n\\n    (/ (+ ??terms)\\n       (? ?d v/number?))\\n    => (+ (?? #(map (fn [n]\\n                      (r/template % (/ ~n ?d)))\\n                    (% '??terms))))\\n\\n    (/ (* (? ?n v/number?) ??factors)\\n       (? ?d v/number?))\\n    =>\\n    (* (? (fn [{n '?n d '?d}]\\n            (g// n d)))\\n       ??factors)\\n\\n    (/ (* ??factors) (? ?d v/number?))\\n    =>\\n    (* (? #(g/invert (% '?d))) ??factors)\\n\\n    (/ ?n\\n       (* (? ?d v/number?) ?factor))\\n    =>\\n    (/ (/ ?n ?d) ?factor)\\n\\n    (/ ?n\\n       (* (? ?d v/number?) ??factors))\\n    =>\\n    (/ (/ ?n ?d) (* ??factors))\\n\\n    (/ ?n (? ?d v/number?))\\n    =>\\n    (* (? #(g/invert (% '?d))) ?n))))\", :nextjournal/opts {:id \"emmy.simplify.rules/divide-numbers-through-code\", :loc {:line 1522, :end-line 1562, :column 1, :end-column 38}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[clojure.lang.AFunction$1 0x27051773 \\\"clojure.lang.AFunction$1@27051773\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/divide-numbers-through-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/divide-numbers-through-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn ^:no-doc occurs-in? [syms all]\\n  (boolean\\n   (seq\\n    (cs/intersection syms all))))\", :nextjournal/opts {:id \"emmy.simplify.rules/occurs-in?-code\", :loc {:line 1564, :end-line 1567, :column 1, :end-column 34}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$occurs_in_QMARK_ 0x36a08cf \\\"emmy.simplify.rules$occurs_in_QMARK_@36a08cf\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/occurs-in?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/occurs-in?-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}} {:path [], :nextjournal/value \"(defn universal-reductions\\n  \\\"Returns a rule simplifier of rules that are almost always helpful.\\\"\\n  [simplify]\\n  (let [misc     (miscsimp simplify)\\n        le       (logexp simplify)\\n        st       (trig:special simplify)\\n        ti       (triginv simplify)\\n        sim-root (simplify-square-roots simplify)]\\n    (fn [expr]\\n      (let [syms     (x/variables-in expr)\\n            sincos?  (occurs-in? #{'sin 'cos} syms)\\n            invtrig? (occurs-in? #{'asin 'acos 'atan} syms)\\n            logexp?  (occurs-in? #{'log 'exp} syms)\\n            sqrt?    (contains? syms 'sqrt)\\n            mag?     (contains? syms 'magnitude)\\n            expr'    (cond-> (misc expr)\\n                       logexp? (le)\\n                       mag? (magnitude)\\n                       invtrig? (ti)\\n                       (and sincos? *sin-cos-simplify?*) (st))]\\n        (cond (and sincos? invtrig?) (sim-root (ti expr'))\\n              sqrt? (sim-root expr')\\n              :else expr')))))\", :nextjournal/opts {:id \"emmy.simplify.rules/universal-reductions-code\", :loc {:line 1569, :end-line 1591, :column 1, :end-column 31}}, :nextjournal/viewer {:name nextjournal.clerk.viewer/code-block-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-code-block, :hash \"5dru1FUcVRTRrVKJFbNw4FG2wXmiwB\"}} {:path [], :nextjournal/value {:nextjournal/presented {:path [], :nextjournal/value \"#object[emmy.simplify.rules$universal_reductions 0x6c8b1065 \\\"emmy.simplify.rules$universal_reductions@6c8b1065\\\"]\", :nextjournal/opts {:id \"emmy.simplify.rules/universal-reductions-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/read+inspect-viewer, :render-fn #viewer-fn (fn [x] (try [nextjournal.clerk.render/inspect (read-string x)] (catch js/Error _e (nextjournal.clerk.render/render-unreadable-edn x)))), :hash \"5driNqLjrByEWrhxqnAqaiYK9eiYCv\"}}, :nextjournal/blob-id nil}, :nextjournal/opts {:id \"emmy.simplify.rules/universal-reductions-result\"}, :nextjournal/viewer {:name nextjournal.clerk.viewer/result-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-result, :hash \"5dtGVHesd2XCTLFYF3aY4kJvkrX1x1\"}}], :css-class nil}, :nextjournal/viewer {:name nextjournal.clerk.viewer/notebook-viewer, :render-fn #viewer-fn nextjournal.clerk.render/render-notebook, :hash \"5duAFDxE4sCnRX71Wo6zeCpC9C3djE\"}}}, :index \"dev/emmy/notebook.clj\", :browse? false, :git/url \"https://github.com/mentat-collective/emmy\", :paths [\"src/emmy/abstract/number.cljc\" \"src/emmy/special/elliptic.cljc\" \"src/emmy/polynomial/interpolate.cljc\" \"src/emmy/numerical/quadrature/midpoint.cljc\" \"src/emmy/numerical/quadrature/trapezoid.cljc\" \"src/emmy/sci.cljc\" \"src/emmy/calculus/map.cljc\" \"src/emmy/pattern/rule.cljc\" \"src/emmy/mechanics/time_evolution.cljc\" \"src/emmy/util/permute.cljc\" \"src/emmy/expression/cse.cljc\" \"src/emmy/complex.cljc\" \"src/emmy/generic.cljc\" \"src/emmy/expression/compile.cljc\" \"src/emmy/sr/frames.cljc\" \"src/emmy/function.cljc\" \"src/emmy/polynomial/richardson.cljc\" \"src/emmy/numerical/unimin/brent.cljc\" \"src/emmy/numsymb.cljc\" \"src/emmy/calculus/vector_field.cljc\" \"src/emmy/numerical/minimize.cljc\" \"src/emmy/rational_function.cljc\" \"src/emmy/mechanics/noether.cljc\" \"src/emmy/calculus/hodge_star.cljc\" \"src/emmy/series.cljc\" \"src/emmy/series/impl.cljc\" \"src/emmy/calculus/manifold.cljc\" \"src/emmy/util/logic.cljc\" \"src/emmy/util/stopwatch.cljc\" \"src/emmy/numerical/quadrature/adaptive.cljc\" \"src/emmy/mechanics/rotation.cljc\" \"src/emmy/numerical/ode.cljc\" \"src/emmy/numerical/quadrature/riemann.cljc\" \"src/emmy/calculus/connection.cljc\" \"src/emmy/numbers.cljc\" \"src/emmy/algebra/fold.cljc\" \"src/emmy/numerical/multimin/nelder_mead.cljc\" \"src/emmy/polynomial/exponent.cljc\" \"src/emmy/polynomial/factor.cljc\" \"src/emmy/util/def.cljc\" \"src/emmy/abstract/function.cljc\" \"src/emmy/calculus/indexed.cljc\" \"src/emmy/numerical/quadrature.cljc\" \"src/emmy/numerical/quadrature/infinite.cljc\" \"src/emmy/mechanics/routhian.cljc\" \"src/emmy/numerical/quadrature/bulirsch_stoer.cljc\" \"src/emmy/ratio.cljc\" \"src/emmy/calculus/curvature.cljc\" \"src/emmy/numerical/quadrature/milne.cljc\" \"src/emmy/calculus/form_field.cljc\" \"src/emmy/mechanics/hamilton.cljc\" \"src/emmy/expression/render.cljc\" \"src/emmy/util/stream.cljc\" \"src/emmy/calculus/derivative.cljc\" \"dev/emmy/notebook.clj\" \"src/emmy/util/aggregate.cljc\" \"src/emmy/numerical/quadrature/romberg.cljc\" \"src/emmy/numerical/quadrature/boole.cljc\" \"src/emmy/pattern/match.cljc\" \"src/emmy/calculus/metric.cljc\" \"src/emmy/polynomial/gcd.cljc\" \"src/emmy/numerical/quadrature/substitute.cljc\" \"src/emmy/euclid.cljc\" \"src/emmy/calculus/vector_calculus.cljc\" \"src/emmy/collection.cljc\" \"src/emmy/numerical/quadrature/simpson.cljc\" \"src/emmy/calculus/basis.cljc\" \"src/emmy/util/vector_set.cljc\" \"src/emmy/pattern/syntax.cljc\" \"src/emmy/numerical/quadrature/common.cljc\" \"src/emmy/sr/boost.cljc\" \"src/emmy/calculus/coordinate.cljc\" \"src/emmy/calculus/covariant.cljc\" \"src/emmy/numerical/derivative.cljc\" \"src/emmy/simplify/rules.cljc\" \"src/emmy/mechanics/rigid.cljc\" \"src/emmy/quaternion.cljc\" \"src/emmy/rational_function/interpolate.cljc\" \"src/emmy/numerical/unimin/bracket.cljc\" \"src/emmy/numerical/roots/bisect.cljc\" \"src/emmy/numerical/quadrature/simpson38.cljc\" \"src/emmy/mechanics/lagrange.cljc\" \"src/emmy/expression/analyze.cljc\" \"src/emmy/calculus/frame.cljc\" \"src/emmy/pattern/consequence.cljc\" \"src/emmy/env.cljc\" \"src/emmy/util.cljc\" \"src/emmy/matrix.cljc\" \"src/emmy/numerical/unimin/golden.cljc\" \"src/emmy/special/factorial.cljc\" \"src/emmy/polynomial/impl.cljc\" \"src/emmy/modint.cljc\"], :resource->url {\"/js/viewer.js\" \"https://storage.clerk.garden/nextjournal/clerk-assets@4NdW4yYfmUzzw9xCkmyrJ75nH75d/viewer.js?immutable=true\"}, :current-path \"src/emmy/simplify/rules.cljc\", :bundle? false, :git/sha \"e16b5692b04972f0bc9ea6d07f7ead41edccc066\", :path->url {\"src/emmy/abstract/number.cljc\" \"src/emmy/abstract/number.html\", \"src/emmy/special/elliptic.cljc\" \"src/emmy/special/elliptic.html\", \"src/emmy/polynomial/interpolate.cljc\" \"src/emmy/polynomial/interpolate.html\", \"src/emmy/numerical/quadrature/midpoint.cljc\" \"src/emmy/numerical/quadrature/midpoint.html\", \"src/emmy/numerical/quadrature/trapezoid.cljc\" \"src/emmy/numerical/quadrature/trapezoid.html\", \"src/emmy/sci.cljc\" \"src/emmy/sci.html\", \"src/emmy/calculus/map.cljc\" \"src/emmy/calculus/map.html\", \"src/emmy/pattern/rule.cljc\" \"src/emmy/pattern/rule.html\", \"src/emmy/mechanics/time_evolution.cljc\" \"src/emmy/mechanics/time_evolution.html\", \"src/emmy/util/permute.cljc\" \"src/emmy/util/permute.html\", \"src/emmy/expression/cse.cljc\" \"src/emmy/expression/cse.html\", \"src/emmy/complex.cljc\" \"src/emmy/complex.html\", \"src/emmy/generic.cljc\" \"src/emmy/generic.html\", \"src/emmy/expression/compile.cljc\" \"src/emmy/expression/compile.html\", \"src/emmy/sr/frames.cljc\" \"src/emmy/sr/frames.html\", \"src/emmy/function.cljc\" \"src/emmy/function.html\", \"src/emmy/polynomial/richardson.cljc\" \"src/emmy/polynomial/richardson.html\", \"src/emmy/numerical/unimin/brent.cljc\" \"src/emmy/numerical/unimin/brent.html\", \"src/emmy/numsymb.cljc\" \"src/emmy/numsymb.html\", \"src/emmy/calculus/vector_field.cljc\" \"src/emmy/calculus/vector_field.html\", \"src/emmy/numerical/minimize.cljc\" \"src/emmy/numerical/minimize.html\", \"src/emmy/rational_function.cljc\" \"src/emmy/rational_function.html\", \"src/emmy/mechanics/noether.cljc\" \"src/emmy/mechanics/noether.html\", \"src/emmy/calculus/hodge_star.cljc\" \"src/emmy/calculus/hodge_star.html\", \"src/emmy/series.cljc\" \"src/emmy/series.html\", \"src/emmy/series/impl.cljc\" \"src/emmy/series/impl.html\", \"src/emmy/calculus/manifold.cljc\" \"src/emmy/calculus/manifold.html\", \"src/emmy/util/logic.cljc\" \"src/emmy/util/logic.html\", \"src/emmy/util/stopwatch.cljc\" \"src/emmy/util/stopwatch.html\", \"src/emmy/numerical/quadrature/adaptive.cljc\" \"src/emmy/numerical/quadrature/adaptive.html\", \"src/emmy/mechanics/rotation.cljc\" \"src/emmy/mechanics/rotation.html\", \"src/emmy/numerical/ode.cljc\" \"src/emmy/numerical/ode.html\", \"src/emmy/numerical/quadrature/riemann.cljc\" \"src/emmy/numerical/quadrature/riemann.html\", \"src/emmy/calculus/connection.cljc\" \"src/emmy/calculus/connection.html\", \"src/emmy/numbers.cljc\" \"src/emmy/numbers.html\", \"src/emmy/algebra/fold.cljc\" \"src/emmy/algebra/fold.html\", \"src/emmy/numerical/multimin/nelder_mead.cljc\" \"src/emmy/numerical/multimin/nelder_mead.html\", \"src/emmy/polynomial/exponent.cljc\" \"src/emmy/polynomial/exponent.html\", \"src/emmy/polynomial/factor.cljc\" \"src/emmy/polynomial/factor.html\", \"src/emmy/util/def.cljc\" \"src/emmy/util/def.html\", \"src/emmy/abstract/function.cljc\" \"src/emmy/abstract/function.html\", \"src/emmy/calculus/indexed.cljc\" \"src/emmy/calculus/indexed.html\", \"src/emmy/numerical/quadrature.cljc\" \"src/emmy/numerical/quadrature.html\", \"src/emmy/numerical/quadrature/infinite.cljc\" \"src/emmy/numerical/quadrature/infinite.html\", \"src/emmy/mechanics/routhian.cljc\" \"src/emmy/mechanics/routhian.html\", \"src/emmy/numerical/quadrature/bulirsch_stoer.cljc\" \"src/emmy/numerical/quadrature/bulirsch_stoer.html\", \"src/emmy/ratio.cljc\" \"src/emmy/ratio.html\", \"src/emmy/calculus/curvature.cljc\" \"src/emmy/calculus/curvature.html\", \"src/emmy/numerical/quadrature/milne.cljc\" \"src/emmy/numerical/quadrature/milne.html\", \"src/emmy/calculus/form_field.cljc\" \"src/emmy/calculus/form_field.html\", \"src/emmy/mechanics/hamilton.cljc\" \"src/emmy/mechanics/hamilton.html\", \"src/emmy/expression/render.cljc\" \"src/emmy/expression/render.html\", \"src/emmy/util/stream.cljc\" \"src/emmy/util/stream.html\", \"src/emmy/calculus/derivative.cljc\" \"src/emmy/calculus/derivative.html\", \"dev/emmy/notebook.clj\" \"\", \"src/emmy/util/aggregate.cljc\" \"src/emmy/util/aggregate.html\", \"src/emmy/numerical/quadrature/romberg.cljc\" \"src/emmy/numerical/quadrature/romberg.html\", \"src/emmy/numerical/quadrature/boole.cljc\" \"src/emmy/numerical/quadrature/boole.html\", \"src/emmy/pattern/match.cljc\" \"src/emmy/pattern/match.html\", \"src/emmy/calculus/metric.cljc\" \"src/emmy/calculus/metric.html\", \"src/emmy/polynomial/gcd.cljc\" \"src/emmy/polynomial/gcd.html\", \"src/emmy/numerical/quadrature/substitute.cljc\" \"src/emmy/numerical/quadrature/substitute.html\", \"src/emmy/euclid.cljc\" \"src/emmy/euclid.html\", \"src/emmy/calculus/vector_calculus.cljc\" \"src/emmy/calculus/vector_calculus.html\", \"src/emmy/collection.cljc\" \"src/emmy/collection.html\", \"src/emmy/numerical/quadrature/simpson.cljc\" \"src/emmy/numerical/quadrature/simpson.html\", \"src/emmy/calculus/basis.cljc\" \"src/emmy/calculus/basis.html\", \"src/emmy/util/vector_set.cljc\" \"src/emmy/util/vector_set.html\", \"src/emmy/pattern/syntax.cljc\" \"src/emmy/pattern/syntax.html\", \"src/emmy/numerical/quadrature/common.cljc\" \"src/emmy/numerical/quadrature/common.html\", \"src/emmy/sr/boost.cljc\" \"src/emmy/sr/boost.html\", \"src/emmy/calculus/coordinate.cljc\" \"src/emmy/calculus/coordinate.html\", \"src/emmy/calculus/covariant.cljc\" \"src/emmy/calculus/covariant.html\", \"src/emmy/numerical/derivative.cljc\" \"src/emmy/numerical/derivative.html\", \"src/emmy/simplify/rules.cljc\" \"src/emmy/simplify/rules.html\", \"src/emmy/mechanics/rigid.cljc\" \"src/emmy/mechanics/rigid.html\", \"src/emmy/quaternion.cljc\" \"src/emmy/quaternion.html\", \"src/emmy/rational_function/interpolate.cljc\" \"src/emmy/rational_function/interpolate.html\", \"src/emmy/numerical/unimin/bracket.cljc\" \"src/emmy/numerical/unimin/bracket.html\", \"src/emmy/numerical/roots/bisect.cljc\" \"src/emmy/numerical/roots/bisect.html\", \"src/emmy/numerical/quadrature/simpson38.cljc\" \"src/emmy/numerical/quadrature/simpson38.html\", \"src/emmy/mechanics/lagrange.cljc\" \"src/emmy/mechanics/lagrange.html\", \"src/emmy/expression/analyze.cljc\" \"src/emmy/expression/analyze.html\", \"src/emmy/calculus/frame.cljc\" \"src/emmy/calculus/frame.html\", \"src/emmy/pattern/consequence.cljc\" \"src/emmy/pattern/consequence.html\", \"src/emmy/env.cljc\" \"src/emmy/env.html\", \"src/emmy/util.cljc\" \"src/emmy/util.html\", \"src/emmy/matrix.cljc\" \"src/emmy/matrix.html\", \"src/emmy/numerical/unimin/golden.cljc\" \"src/emmy/numerical/unimin/golden.html\", \"src/emmy/special/factorial.cljc\" \"src/emmy/special/factorial.html\", \"src/emmy/polynomial/impl.cljc\" \"src/emmy/polynomial/impl.html\", \"src/emmy/modint.cljc\" \"src/emmy/modint.html\"}, :expanded-paths [\"src/emmy/expression/analyze.cljc\" \"src/emmy/expression/render.cljc\" \"src/emmy/expression/cse.cljc\" \"src/emmy/expression/compile.cljc\" \"src/emmy/sr/boost.cljc\" \"src/emmy/sr/frames.cljc\" \"src/emmy/calculus/form_field.cljc\" \"src/emmy/calculus/vector_field.cljc\" \"src/emmy/calculus/basis.cljc\" \"src/emmy/calculus/coordinate.cljc\" \"src/emmy/calculus/connection.cljc\" \"src/emmy/calculus/vector_calculus.cljc\" \"src/emmy/calculus/frame.cljc\" \"src/emmy/calculus/curvature.cljc\" \"src/emmy/calculus/manifold.cljc\" \"src/emmy/calculus/indexed.cljc\" \"src/emmy/calculus/derivative.cljc\" \"src/emmy/calculus/map.cljc\" \"src/emmy/calculus/covariant.cljc\" \"src/emmy/calculus/hodge_star.cljc\" \"src/emmy/calculus/metric.cljc\" \"src/emmy/series/impl.cljc\" \"src/emmy/rational_function/interpolate.cljc\" \"src/emmy/polynomial/richardson.cljc\" \"src/emmy/polynomial/interpolate.cljc\" \"src/emmy/polynomial/factor.cljc\" \"src/emmy/polynomial/exponent.cljc\" \"src/emmy/polynomial/gcd.cljc\" \"src/emmy/polynomial/impl.cljc\" \"src/emmy/pattern/consequence.cljc\" \"src/emmy/pattern/match.cljc\" \"src/emmy/pattern/rule.cljc\" \"src/emmy/pattern/syntax.cljc\" \"src/emmy/util/vector_set.cljc\" \"src/emmy/util/permute.cljc\" \"src/emmy/util/stream.cljc\" \"src/emmy/util/def.cljc\" \"src/emmy/util/stopwatch.cljc\" \"src/emmy/util/logic.cljc\" \"src/emmy/util/aggregate.cljc\" \"src/emmy/numerical/roots/bisect.cljc\" \"src/emmy/numerical/quadrature/simpson.cljc\" \"src/emmy/numerical/quadrature/simpson38.cljc\" \"src/emmy/numerical/quadrature/substitute.cljc\" \"src/emmy/numerical/quadrature/boole.cljc\" \"src/emmy/numerical/quadrature/infinite.cljc\" \"src/emmy/numerical/quadrature/common.cljc\" \"src/emmy/numerical/quadrature/romberg.cljc\" \"src/emmy/numerical/quadrature/adaptive.cljc\" \"src/emmy/numerical/quadrature/riemann.cljc\" \"src/emmy/numerical/quadrature/trapezoid.cljc\" \"src/emmy/numerical/quadrature/milne.cljc\" \"src/emmy/numerical/quadrature/bulirsch_stoer.cljc\" \"src/emmy/numerical/quadrature/midpoint.cljc\" \"src/emmy/numerical/minimize.cljc\" \"src/emmy/numerical/ode.cljc\" \"src/emmy/numerical/quadrature.cljc\" \"src/emmy/numerical/derivative.cljc\" \"src/emmy/numerical/unimin/golden.cljc\" \"src/emmy/numerical/unimin/bracket.cljc\" \"src/emmy/numerical/unimin/brent.cljc\" \"src/emmy/numerical/multimin/nelder_mead.cljc\" \"src/emmy/simplify/rules.cljc\" \"src/emmy/abstract/function.cljc\" \"src/emmy/abstract/number.cljc\" \"src/emmy/mechanics/hamilton.cljc\" \"src/emmy/mechanics/routhian.cljc\" \"src/emmy/mechanics/noether.cljc\" \"src/emmy/mechanics/lagrange.cljc\" \"src/emmy/mechanics/time_evolution.cljc\" \"src/emmy/mechanics/rotation.cljc\" \"src/emmy/mechanics/rigid.cljc\" \"src/emmy/algebra/fold.cljc\" \"src/emmy/special/elliptic.cljc\" \"src/emmy/special/factorial.cljc\" \"src/emmy/collection.cljc\" \"src/emmy/complex.cljc\" \"src/emmy/euclid.cljc\" \"src/emmy/env.cljc\" \"src/emmy/function.cljc\" \"src/emmy/generic.cljc\" \"src/emmy/matrix.cljc\" \"src/emmy/modint.cljc\" \"src/emmy/numbers.cljc\" \"src/emmy/numsymb.cljc\" \"src/emmy/quaternion.cljc\" \"src/emmy/ratio.cljc\" \"src/emmy/rational_function.cljc\" \"src/emmy/sci.cljc\" \"src/emmy/series.cljc\" \"src/emmy/util.cljc\" \"dev/emmy/notebook.clj\"], :cname \"emmy.mentat.org\", :watch-paths [\"src\" \"dev\"], :report-fn #object[nextjournal.clerk.builder$stdout_reporter 0x14894041 \"nextjournal.clerk.builder$stdout_reporter@14894041\"]}".replaceAll('nextjournal.clerk.view/escape-closing-script-tag', 'script')
let opts = nextjournal.clerk.sci_env.read_string(state)
nextjournal.clerk.static_app.init(opts)
</script></body></html>